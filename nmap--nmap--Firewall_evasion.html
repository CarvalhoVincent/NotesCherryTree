<!doctype html><html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>nmap--Firewall evasion</title>
      <meta name="generator" content="CherryTree">
      <link rel="stylesheet" href="res/styles3.css" type="text/css" />
    </head>
    <body><div class='page'><h1 class='title'>nmap--Firewall evasion</h1><br/><br />We have already seen some techniques for bypassing firewalls (think  stealth scans, along with NULL, FIN and Xmas scans); however, there is  another very common firewall configuration which it&#39;s imperative we know  how to bypass.<br />Your typical Windows host will, with its default  firewall, block all ICMP packets. This presents a problem: not only do  we often use <em>ping</em> to manually establish the activity of a target,  Nmap does the same thing by default. This means that Nmap will register  a host with this firewall configuration as dead and not bother scanning  it at all. <br />So, we need a way to get around this configuration. Fortunately Nmap provides an option for this: <code>-Pn</code>,  which tells Nmap to not bother pinging the host before scanning it.  This means that Nmap will always treat the target host(s) as being  alive, effectively bypassing the ICMP block; however, it comes at the  price of potentially taking a very long time to complete the scan (if  the host really is dead then Nmap will still be checking and double  checking every specified port). <br />It&#39;s worth noting that if you&#39;re  already directly on the local network, Nmap can also use ARP requests to  determine host activity. <br />There are a variety of other  switches which Nmap considers useful for firewall evasion. We will not  go through these in detail, however, they can be found <a href="https://nmap.org/book/man-bypass-firewalls-ids.html">here</a>.<br />The following switches are of particular note:<br />• <code>-f</code>:- Used to fragment the packets (i.e. split them into smaller pieces) making it less likely that the packets will be detected by a firewall or IDS. <br />• An alternative to <code>-f</code>, but providing more control over the size of the packets: <code>--mtu &lt;number&gt;</code>, accepts a maximum transmission unit size to use for the packets sent. This <em>must</em> be a multiple of 8.<br />• <code>--scan-delay &lt;time&gt;ms</code>:- used to add a delay between packets sent. This is very useful if the network is unstable, but also for evading any time-based firewall/IDS triggers which may be in place.<br />• <code>--badsum</code>:- this is used to generate in invalid checksum for packets. Any real TCP/IP stack would drop this packet, however, firewalls may potentially respond automatically, without bothering to check the checksum of the packet. As such, this switch can be used to determine the presence of a firewall/IDS.<br /><br /></div></body></html>